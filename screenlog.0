===> Start PROTEUS <===
Read in init file: /home/n/nichollsh/PROTEUS/init_coupler.cfg
Settings:
star_spectrum               = spec_gj1132.txt  
star_rot_percentile         = 50.0      
star_mass                   = 0.194     
star_radius_modern          = 0.215     
star_temperature_modern     = 3196.0    
mean_distance               = 0.0153    
gravity                     = 9.81      
radius                      = 6.378e+6  
zenith_angle                = 54.55     
albedo_s   	                = 0.0 		
albedo_pl   	            = 0.175 	
P_top                       = 1.0e-5    
time_star                   = 100e+6  	
time_planet                 = 0.        
time_target                 = 4.567e+9  
plot_onthefly               = 1
sflux_dt_update             = 1.0e4
N2_partitioning             = 1
shallow_layer               = 0
flux_convergence            = 1         
F_eps                       = 1.0       
F_diff                      = 0.1       
RF_crit                     = 0.01      
dTs_atm                     = 30        
phi_crit                    = 0.005     
solid_stop                  = 1
IC_INTERIOR                 = 1
SURFACE_BC                  = 4
SEPARATION                  = 0
mixing_length               = 2
PARAM_UTBL                  = 0               
param_utbl_const            = 1.0E-7          
solver_tolerance            = 1.0e-10
tsurf_poststep_change       = 30.0
tsurf_poststep_change_frac  = 0.05
planet_coresize             = 0.55
ic_interior_filename        = 0
nstepsmacro                 = 1
dtmacro                     = 10000
dtswitch                    = 100000
F_atm                       = 1.0E4
IC_ATMOSPHERE               = 3
H2O_initial_total_abundance = 0   
CO2_initial_total_abundance = 0
H2_initial_total_abundance  = 0
CH4_initial_total_abundance = 0
CO_initial_total_abundance  = 0
N2_initial_total_abundance  = 0
O2_initial_total_abundance  = 0
S_initial_total_abundance   = 0
He_initial_total_abundance  = 0
H2O_initial_atmos_pressure  = 2.00e5
CO2_initial_atmos_pressure  = 0.00
H2_initial_atmos_pressure   = 4.00e5
CH4_initial_atmos_pressure  = 1.00e5
CO_initial_atmos_pressure   = 0.00
N2_initial_atmos_pressure   = 0.00
O2_initial_atmos_pressure   = 0.00
S_initial_atmos_pressure    = 0.00
He_initial_atmos_pressure   = 0.00
H2O_poststep_change         = 0.05
CO2_poststep_change         = 0.05
H2_poststep_change          = 0.05
CH4_poststep_change         = 0.05
CO_poststep_change          = 0.05
N2_poststep_change          = 0.05
O2_poststep_change          = 0.05
S_poststep_change           = 0.05
He_poststep_change          = 0.05
use_vulcan                  = 0
Modern spectrum F_band values:
Band xr [0,10] = 0.101133
Band e1 [10,32] = 0.0821785
Band e2 [32,92] = 0.0259823
Band uv [92,300] = 0.667811
Band pl [300,12999] = 6409.45
Band bo [0,12999] = 6410.33
observed_vs_planckian = 1.0859508784897447
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:::::::::::: START COUPLER RUN | 2023-05-27_14-40-57
:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
Updating stellar spectrum
17887520444.144146 cm
3309.5063399284177 K
{'xr': 6.902828843888996, 'e1': 5.583391656754739, 'e2': 1.5327284324663473, 'pl': 10540.457204617265}
{'xr': 68.25506164872746, 'e1': 67.94220343465727, 'e2': 58.99136408551082, 'pl': 1.6445183535356716}
Start interior
IC_INTERIOR = 1
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 0, 'init': 0, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    1
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    10000.0
    -teqm
    623.9014079224754
    -nstepsmacro
    1
    -dtmacro
    0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100000.0
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         0               0               s
nstepsmacro     1              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 0.000000, Will perform 1 macro (output) steps of length 0.000000 = 0.000000 years
***  Writing output at macro Step 0, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 0
  SUNDIALS no. of calls to rhs function 0
  SUNDIALS no. of calls to linear solver setup function 0
  SUNDIALS no. of error test failures 0
  SUNDIALS no. of nonlinear solver iterations 0
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94340523988896
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 8389191725467304052
  maximum steps=100000000
  maximum time=0.
  total number of nonlinear solver iterations=0
  total number of linear solver iterations=0
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 1, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 10734474.643093368 F_int: 10000.000000000004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 0, 'init': 0, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
>>> Generate scatter spectral file dir: /home/n/nichollsh/PROTEUS/output//scatter_spectral_file/
>>> Copy non-scatter spectral file to: /home/n/nichollsh/PROTEUS/output//scatter_spectral_file/
Mapping sub-bands to channels.
Mapping sub-bands to channels.
exec_submit.sh insert_star_spectrum.sh pt_grid_cia.dat pt_grid_lbl.dat sp_b318_HITRAN_a16 sp_b318_HITRAN_a16_F2V_hd128167 sp_b318_HITRAN_a16_F2V_hd128167_k sp_b318_HITRAN_a16_k sp_b318_HITRAN_a16_M45_ADLeo sp_b318_HITRAN_a16_M45_ADLeo_k sp_b318_HITRAN_a16_no_spectrum sp_b318_HITRAN_a16_no_spectrum_k sp_b318_HITRAN_a16_Sun_t0_0Ga_claire_12 sp_b318_HITRAN_a16_Sun_t0_0Ga_claire_12_k sp_b318_HITRAN_a16_Sun_t3_5Ga_claire_12 sp_b318_HITRAN_a16_Sun_t3_5Ga_claire_12_k sp_b318_HITRAN_a16_Sun_t4_4Ga_claire_12 sp_b318_HITRAN_a16_Sun_t4_4Ga_claire_12_k sp_b318_HITRAN_a16_Sun_t456myr_kurucz_95 sp_b318_HITRAN_a16_Sun_t456myr_kurucz_95_k sp_exec_sp_b318_HITRAN_a16.sh sp_gen_script.py sp_submit_cluster.sh TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-41-29
LOOP: {'total': 0, 'init': 0, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0
T_s [K]: 2707.9736565014723
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[2 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 10734474.643093368
F_atm [W/m^2]: 20744.236328125
F_net [W/m^2]: -1.0
Last file name: 0.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0]
Start interior
IC_INTERIOR = 1
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 1, 'init': 1, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    1
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20744.236328125
    -teqm
    623.9014079224754
    -nstepsmacro
    1
    -dtmacro
    0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100000.0
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         0               0               s
nstepsmacro     1              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 0.000000, Will perform 1 macro (output) steps of length 0.000000 = 0.000000 years
***  Writing output at macro Step 0, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 0
  SUNDIALS no. of calls to rhs function 0
  SUNDIALS no. of calls to linear solver setup function 0
  SUNDIALS no. of error test failures 0
  SUNDIALS no. of nonlinear solver iterations 0
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94920256030624
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 8389191725467304052
  maximum steps=100000000
  maximum time=0.
  total number of nonlinear solver iterations=0
  total number of linear solver iterations=0
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 1, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 10734474.643093368 F_int: 20744.236328125
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 1, 'init': 1, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-41-59
LOOP: {'total': 1, 'init': 1, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0
T_s [K]: 2707.9736565014723
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[4 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 10734474.643093368
F_atm [W/m^2]: 20744.236328125
F_net [W/m^2]: -1.0
Last file name: 0.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0]
Start interior
IC_INTERIOR = 1
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 2, 'init': 2, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    1
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20744.236328125
    -teqm
    623.9014079224754
    -nstepsmacro
    1
    -dtmacro
    0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100000.0
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         0               0               s
nstepsmacro     1              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 0.000000, Will perform 1 macro (output) steps of length 0.000000 = 0.000000 years
***  Writing output at macro Step 0, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 0
  SUNDIALS no. of calls to rhs function 0
  SUNDIALS no. of calls to linear solver setup function 0
  SUNDIALS no. of error test failures 0
  SUNDIALS no. of nonlinear solver iterations 0
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93915915712416
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 8389191725467304052
  maximum steps=100000000
  maximum time=0.
  total number of nonlinear solver iterations=0
  total number of linear solver iterations=0
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 1, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 10734474.643093368 F_int: 20744.236328125
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 2, 'init': 2, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-42-27
LOOP: {'total': 2, 'init': 2, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0
T_s [K]: 2707.9736565014723
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[6 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 10734474.643093368
F_atm [W/m^2]: 20744.236328125
F_net [W/m^2]: -1.0
Last file name: 0.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4567000000.0 1.0 2
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 3, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20744.236328125
    -teqm
    623.9014079224754
    -nstepsmacro
    2
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100000.0
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//0.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     2              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 0.000000, Will perform 2 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 1, t=0.000000. [0:00:00:00]
     Actual time: 0 years, Desired time: 0 years
  Field 0 Min/Max -0.011427/-0.008306
  Field 1 Min/Max 0.868686/0.868686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 775
  SUNDIALS no. of calls to rhs function 1008
  SUNDIALS no. of calls to linear solver setup function 108
  SUNDIALS no. of error test failures 41
  SUNDIALS no. of nonlinear solver iterations 1007
  SUNDIALS no. of nonlinear convergence failure 4
  SUNDIALS no. of Jacobian-vector product evaluations 94620231477440
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 731
  maximum steps=100000000
  maximum time=315.576
  total number of RHS function evaluations=2352
  total number of nonlinear solver iterations=379264
  total number of linear solver iterations=2101879744
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 2, t=315.576000. [0:00:00:01]
     Actual time: 1 years, Desired time: 1 years
  Field 0 Min/Max -0.019615/-0.000005
  Field 1 Min/Max 0.868949/0.868949
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20765.57680412107 F_int: 20744.236328125
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 3, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-42-57
LOOP: {'total': 3, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 1e-06
T_s [K]: 2709.0810640063287
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1    Interior  2709.081064  2.076558e+04  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1  Atmosphere  2709.081064  2.076558e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[8 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20765.57680412107
F_atm [W/m^2]: 20803.271484375
F_net [W/m^2]: -1.0
Last file name: 1.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999999.0 1.0 3
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 4, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20803.271484375
    -teqm
    623.901406997489
    -nstepsmacro
    3
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//1.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     3              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 315.576000, Will perform 3 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 2, t=315.576000. [0:00:00:00]
     Actual time: 1 years, Desired time: 1 years
  Field 0 Min/Max -0.019615/-0.000005
  Field 1 Min/Max 0.868949/0.868949
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 91
  SUNDIALS no. of calls to rhs function 109
  SUNDIALS no. of calls to linear solver setup function 21
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 108
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94923854452928
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 56
  maximum steps=100000000
  maximum time=631.152
  total number of RHS function evaluations=365
  total number of nonlinear solver iterations=5347
  total number of linear solver iterations=782177216
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 3, t=631.152000. [0:00:00:00]
     Actual time: 2 years, Desired time: 2 years
  Field 0 Min/Max -0.019690/-0.000005
  Field 1 Min/Max 0.868944/0.868944
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20824.909955051957 F_int: 20803.271484375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 4, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-43-27
LOOP: {'total': 4, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 2e-06
T_s [K]: 2709.056486218811
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1    Interior  2709.081064  2.076558e+04  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1  Atmosphere  2709.081064  2.076558e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2    Interior  2709.056486  2.082491e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2  Atmosphere  2709.056486  2.082491e+04  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20824.909955051957
F_atm [W/m^2]: 20801.9609375
F_net [W/m^2]: -1.0
Last file name: 2.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1 2]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999998.0 1.0 4
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 5, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20801.9609375
    -teqm
    623.9014060725024
    -nstepsmacro
    4
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//2.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     4              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 631.152000, Will perform 4 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 3, t=631.152000. [0:00:00:00]
     Actual time: 2 years, Desired time: 2 years
  Field 0 Min/Max -0.019690/-0.000005
  Field 1 Min/Max 0.868944/0.868944
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94869078304960
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=946.728
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=1840604096
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 4, t=946.728000. [0:00:00:00]
     Actual time: 3 years, Desired time: 3 years
  Field 0 Min/Max -0.019765/-0.000005
  Field 1 Min/Max 0.868938/0.868938
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20823.601447227633 F_int: 20801.9609375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 5, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-43-56
LOOP: {'total': 5, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 3e-06
T_s [K]: 2709.0318974186002
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1    Interior  2709.081064  2.076558e+04  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1  Atmosphere  2709.081064  2.076558e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2    Interior  2709.056486  2.082491e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2  Atmosphere  2709.056486  2.082491e+04  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3    Interior  2709.031897  2.082360e+04  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3  Atmosphere  2709.031897  2.082360e+04  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20823.601447227633
F_atm [W/m^2]: 20800.66015625
F_net [W/m^2]: -1.0
Last file name: 3.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1 2 3]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999997.0 1.0 5
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 6, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20800.66015625
    -teqm
    623.9014051475158
    -nstepsmacro
    5
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//3.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     5              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 946.728000, Will perform 5 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 4, t=946.728000. [0:00:00:00]
     Actual time: 3 years, Desired time: 3 years
  Field 0 Min/Max -0.019765/-0.000005
  Field 1 Min/Max 0.868938/0.868938
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94860405967040
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=1262.3
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=1758200768
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 5, t=1262.304000. [0:00:00:00]
     Actual time: 4 years, Desired time: 4 years
  Field 0 Min/Max -0.019841/-0.000005
  Field 1 Min/Max 0.868932/0.868932
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20822.302656923242 F_int: 20800.660156250004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 6, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-44-28
LOOP: {'total': 6, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 4e-06
T_s [K]: 2709.0073060225936
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    0    Interior  2707.973657  1.073447e+07      0.000000  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    0  Atmosphere  2707.973657  1.073447e+07  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1    Interior  2709.081064  2.076558e+04  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1  Atmosphere  2709.081064  2.076558e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2    Interior  2709.056486  2.082491e+04  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2  Atmosphere  2709.056486  2.082491e+04  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3    Interior  2709.031897  2.082360e+04  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3  Atmosphere  2709.031897  2.082360e+04  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4    Interior  2709.007306  2.082230e+04  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4  Atmosphere  2709.007306  2.082230e+04  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20822.302656923242
F_atm [W/m^2]: 20799.34765625
F_net [W/m^2]: -1.0
Last file name: 4.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1 2 3 4]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999996.0 1.0 6
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 7, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20799.34765625
    -teqm
    623.9014042225291
    -nstepsmacro
    6
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//4.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     6              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 1262.304000, Will perform 6 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 5, t=1262.304000. [0:00:00:00]
     Actual time: 4 years, Desired time: 4 years
  Field 0 Min/Max -0.019841/-0.000005
  Field 1 Min/Max 0.868932/0.868932
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94700331468992
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=1577.88
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=597492672
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 6, t=1577.880000. [0:00:00:00]
     Actual time: 5 years, Desired time: 5 years
  Field 0 Min/Max -0.019916/-0.000005
  Field 1 Min/Max 0.868926/0.868926
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20820.992144249853 F_int: 20799.34765625
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 7, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-45-01
LOOP: {'total': 7, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 5e-06
T_s [K]: 2708.9827120547534
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    1    Interior  2709.081064  20765.576804  20744.236328  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    1  Atmosphere  2709.081064  20765.576804  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2    Interior  2709.056486  20824.909955  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2  Atmosphere  2709.056486  20824.909955  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3    Interior  2709.031897  20823.601447  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3  Atmosphere  2709.031897  20823.601447  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4    Interior  2709.007306  20822.302657  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4  Atmosphere  2709.007306  20822.302657  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5    Interior  2708.982712  20820.992144  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5  Atmosphere  2708.982712  20820.992144  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20820.992144249853
F_atm [W/m^2]: 20798.03125
F_net [W/m^2]: -1.0
Last file name: 5.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1 2 3 4 5]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999995.0 1.0 7
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 8, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20798.03125
    -teqm
    623.9014032975425
    -nstepsmacro
    7
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//5.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     7              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 1577.880000, Will perform 7 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 6, t=1577.880000. [0:00:00:00]
     Actual time: 5 years, Desired time: 5 years
  Field 0 Min/Max -0.019916/-0.000005
  Field 1 Min/Max 0.868926/0.868926
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94130407393472
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=1893.46
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=1904067520
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 7, t=1893.456000. [0:00:00:00]
     Actual time: 6 years, Desired time: 6 years
  Field 0 Min/Max -0.019992/-0.000005
  Field 1 Min/Max 0.868920/0.868920
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20819.677730915297 F_int: 20798.031250000004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 8, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-45-34
LOOP: {'total': 8, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 6e-06
T_s [K]: 2708.9581155055616
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    2    Interior  2709.056486  20824.909955  20803.271484  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    2  Atmosphere  2709.056486  20824.909955  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3    Interior  2709.031897  20823.601447  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3  Atmosphere  2709.031897  20823.601447  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4    Interior  2709.007306  20822.302657  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4  Atmosphere  2709.007306  20822.302657  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5    Interior  2708.982712  20820.992144  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5  Atmosphere  2708.982712  20820.992144  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6    Interior  2708.958116  20819.677731  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6  Atmosphere  2708.958116  20819.677731  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20819.677730915297
F_atm [W/m^2]: 20796.720703125
F_net [W/m^2]: -1.0
Last file name: 6.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1 2 3 4 5 6]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999994.0 1.0 8
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 9, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20796.720703125
    -teqm
    623.9014023725559
    -nstepsmacro
    8
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//6.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     8              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 1893.456000, Will perform 8 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 7, t=1893.456000. [0:00:00:00]
     Actual time: 6 years, Desired time: 6 years
  Field 0 Min/Max -0.019992/-0.000005
  Field 1 Min/Max 0.868920/0.868920
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94030710433984
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=2209.03
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=991355840
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 8, t=2209.032000. [0:00:00:00]
     Actual time: 7 years, Desired time: 7 years
  Field 0 Min/Max -0.020069/-0.000005
  Field 1 Min/Max 0.868914/0.868914
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20818.369192287402 F_int: 20796.720703125004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 9, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-46-02
LOOP: {'total': 9, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 7e-06
T_s [K]: 2708.933516352787
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    3    Interior  2709.031897  20823.601447  20801.960938  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    3  Atmosphere  2709.031897  20823.601447  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4    Interior  2709.007306  20822.302657  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4  Atmosphere  2709.007306  20822.302657  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5    Interior  2708.982712  20820.992144  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5  Atmosphere  2708.982712  20820.992144  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6    Interior  2708.958116  20819.677731  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6  Atmosphere  2708.958116  20819.677731  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7    Interior  2708.933516  20818.369192  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7  Atmosphere  2708.933516  20818.369192  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20818.369192287402
F_atm [W/m^2]: 20795.40625
F_net [W/m^2]: -1.0
Last file name: 7.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0 1 2 3 4 5 6 7]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999993.0 1.0 9
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 10, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20795.40625
    -teqm
    623.9014014475694
    -nstepsmacro
    9
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//7.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     9              
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 2209.032000, Will perform 9 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 8, t=2209.032000. [0:00:00:00]
     Actual time: 7 years, Desired time: 7 years
  Field 0 Min/Max -0.020069/-0.000005
  Field 1 Min/Max 0.868914/0.868914
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94079883905216
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=2524.61
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=-1374780480
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 9, t=2524.608000. [0:00:00:00]
     Actual time: 8 years, Desired time: 8 years
  Field 0 Min/Max -0.020145/-0.000005
  Field 1 Min/Max 0.868908/0.868908
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20817.05675256485 F_int: 20795.406249999996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 10, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-46-34
LOOP: {'total': 10, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 8e-06
T_s [K]: 2708.908914594974
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    4    Interior  2709.007306  20822.302657  20800.660156  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    4  Atmosphere  2709.007306  20822.302657  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5    Interior  2708.982712  20820.992144  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5  Atmosphere  2708.982712  20820.992144  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6    Interior  2708.958116  20819.677731  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6  Atmosphere  2708.958116  20819.677731  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7    Interior  2708.933516  20818.369192  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7  Atmosphere  2708.933516  20818.369192  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8    Interior  2708.908915  20817.056753  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8  Atmosphere  2708.908915  20817.056753  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20817.05675256485
F_atm [W/m^2]: 20794.095703125
F_net [W/m^2]: -1.0
Last file name: 8.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 0, 1, 1, 1, 2, 2, 3, 4, 6, 8]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999992.0 1.0 10
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 11, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20794.095703125
    -teqm
    623.9014005225828
    -nstepsmacro
    10
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//8.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     10             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 2524.608000, Will perform 10 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 9, t=2524.608000. [0:00:00:00]
     Actual time: 8 years, Desired time: 8 years
  Field 0 Min/Max -0.020145/-0.000005
  Field 1 Min/Max 0.868908/0.868908
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94161322870976
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=2840.18
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=-1540193344
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 10, t=2840.184000. [0:00:00:00]
     Actual time: 9 years, Desired time: 9 years
  Field 0 Min/Max -0.020222/-0.000005
  Field 1 Min/Max 0.868902/0.868902
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20815.74823261402 F_int: 20794.095703125
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 11, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-47-03
LOOP: {'total': 11, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 9e-06
T_s [K]: 2708.8843102131796
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    5    Interior  2708.982712  20820.992144  20799.347656  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    5  Atmosphere  2708.982712  20820.992144  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6    Interior  2708.958116  20819.677731  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6  Atmosphere  2708.958116  20819.677731  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7    Interior  2708.933516  20818.369192  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7  Atmosphere  2708.933516  20818.369192  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8    Interior  2708.908915  20817.056753  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8  Atmosphere  2708.908915  20817.056753  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9    Interior  2708.884310  20815.748233  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9  Atmosphere  2708.884310  20815.748233  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20815.74823261402
F_atm [W/m^2]: 20792.78125
F_net [W/m^2]: -1.0
Last file name: 9.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 0, 1, 1, 1, 2, 3, 4, 5, 6, 9]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
1 1 4566999991.0 1.0 11
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 12, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20792.78125
    -teqm
    623.9013995975961
    -nstepsmacro
    11
    -dtmacro
    1
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//9.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         315.576         3.15576e+07     s
nstepsmacro     11             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 2840.184000, Will perform 11 macro (output) steps of length 315.576000 = 1.000000 years
***  Writing output at macro Step 10, t=2840.184000. [0:00:00:00]
     Actual time: 9 years, Desired time: 9 years
  Field 0 Min/Max -0.020222/-0.000005
  Field 1 Min/Max 0.868902/0.868902
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 43
  SUNDIALS no. of calls to rhs function 51
  SUNDIALS no. of calls to linear solver setup function 16
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 50
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94534680131776
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=3155.76
  total number of RHS function evaluations=179
  total number of nonlinear solver iterations=1178
  total number of linear solver iterations=-1845087296
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 11, t=3155.760000. [0:00:00:00]
     Actual time: 10 years, Desired time: 10 years
  Field 0 Min/Max -0.020299/-0.000005
  Field 1 Min/Max 0.868896/0.868896
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20814.435811557007 F_int: 20792.78125
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 12, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-47-36
LOOP: {'total': 12, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 1e-05
T_s [K]: 2708.8597032049606
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    6    Interior  2708.958116  20819.677731  20798.031250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    6  Atmosphere  2708.958116  20819.677731  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7    Interior  2708.933516  20818.369192  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7  Atmosphere  2708.933516  20818.369192  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8    Interior  2708.908915  20817.056753  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8  Atmosphere  2708.908915  20817.056753  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9    Interior  2708.884310  20815.748233  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9  Atmosphere  2708.884310  20815.748233  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10    Interior  2708.859703  20814.435812  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10  Atmosphere  2708.859703  20814.435812  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20814.435811557007
F_atm [W/m^2]: 20791.466796875
F_net [W/m^2]: -1.0
Last file name: 10.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 1, 1, 1, 2, 2, 3, 4, 5, 7, 10]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999990.0 5.0 14
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 13, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20791.466796875
    -teqm
    623.9013986726095
    -nstepsmacro
    14
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//10.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     14             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 3155.760000, Will perform 14 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 11, t=3155.760000. [0:00:00:00]
     Actual time: 10 years, Desired time: 10 years
  Field 0 Min/Max -0.020299/-0.000005
  Field 1 Min/Max 0.868896/0.868896
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 46
  SUNDIALS no. of calls to rhs function 54
  SUNDIALS no. of calls to linear solver setup function 17
  SUNDIALS no. of error test failures 1
  SUNDIALS no. of nonlinear solver iterations 53
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94143259244736
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 0
  maximum steps=100000000
  maximum time=3786.91
  total number of RHS function evaluations=182
  total number of nonlinear solver iterations=1334
  total number of linear solver iterations=1871016896
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 12, t=3786.912000. [0:00:00:00]
     Actual time: 12 years, Desired time: 12 years
  Field 0 Min/Max -0.020455/-0.000005
  Field 1 Min/Max 0.868884/0.868884
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 13, t=4418.064000. [0:00:00:00]
     Actual time: 14 years, Desired time: 14 years
  Field 0 Min/Max -0.020611/-0.000005
  Field 1 Min/Max 0.868872/0.868872
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 14, t=5049.216000. [0:00:00:00]
     Actual time: 16 years, Desired time: 16 years
  Field 0 Min/Max -0.020769/-0.000005
  Field 1 Min/Max 0.868860/0.868860
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20813.140609365968 F_int: 20791.466796875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 13, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-48-07
LOOP: {'total': 13, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 1.6e-05
T_s [K]: 2708.711978894727
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    7    Interior  2708.933516  20818.369192  20796.720703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    7  Atmosphere  2708.933516  20818.369192  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8    Interior  2708.908915  20817.056753  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8  Atmosphere  2708.908915  20817.056753  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9    Interior  2708.884310  20815.748233  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9  Atmosphere  2708.884310  20815.748233  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10    Interior  2708.859703  20814.435812  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10  Atmosphere  2708.859703  20814.435812  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16    Interior  2708.711979  20813.140609  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16  Atmosphere  2708.711979  20813.140609  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20813.140609365968
F_atm [W/m^2]: 20783.591796875
F_net [W/m^2]: -1.0
Last file name: 16.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 1, 1, 2, 2, 3, 4, 6, 7, 10, 16]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999984.0 5.0 17
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 14, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20783.591796875
    -teqm
    623.9013931226897
    -nstepsmacro
    17
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//16.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     17             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 5049.216000, Will perform 17 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 14, t=5049.216000. [0:00:00:00]
     Actual time: 16 years, Desired time: 16 years
  Field 0 Min/Max -0.020769/-0.000005
  Field 1 Min/Max 0.868860/0.868860
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 68
  SUNDIALS no. of calls to rhs function 83
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 82
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94614592231616
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=5680.37
  total number of RHS function evaluations=339
  total number of nonlinear solver iterations=3009
  total number of linear solver iterations=757601216
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 15, t=5680.368000. [0:00:00:00]
     Actual time: 18 years, Desired time: 18 years
  Field 0 Min/Max -0.020928/-0.000005
  Field 1 Min/Max 0.868848/0.868848
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 16, t=6311.520000. [0:00:00:00]
     Actual time: 20 years, Desired time: 20 years
  Field 0 Min/Max -0.021088/-0.000005
  Field 1 Min/Max 0.868837/0.868837
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 17, t=6942.672000. [0:00:00:00]
     Actual time: 22 years, Desired time: 22 years
  Field 0 Min/Max -0.021249/-0.000005
  Field 1 Min/Max 0.868825/0.868825
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20805.27836081101 F_int: 20783.591796874996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 14, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-48-37
LOOP: {'total': 14, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 2.2e-05
T_s [K]: 2708.5641602218634
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    8    Interior  2708.908915  20817.056753  20795.406250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    8  Atmosphere  2708.908915  20817.056753  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9    Interior  2708.884310  20815.748233  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9  Atmosphere  2708.884310  20815.748233  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10    Interior  2708.859703  20814.435812  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10  Atmosphere  2708.859703  20814.435812  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16    Interior  2708.711979  20813.140609  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16  Atmosphere  2708.711979  20813.140609  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22    Interior  2708.564160  20805.278361  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22  Atmosphere  2708.564160  20805.278361  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20805.27836081101
F_atm [W/m^2]: 20775.71484375
F_net [W/m^2]: -1.0
Last file name: 22.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 1, 2, 2, 3, 4, 5, 7, 9, 14, 22]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999978.0 5.0 20
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 15, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20775.71484375
    -teqm
    623.9013875727697
    -nstepsmacro
    20
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//22.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     20             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 6942.672000, Will perform 20 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 17, t=6942.672000. [0:00:00:00]
     Actual time: 22 years, Desired time: 22 years
  Field 0 Min/Max -0.021249/-0.000005
  Field 1 Min/Max 0.868825/0.868825
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 71
  SUNDIALS no. of calls to rhs function 85
  SUNDIALS no. of calls to linear solver setup function 23
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 84
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94179011393728
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 51
  maximum steps=100000000
  maximum time=7573.82
  total number of RHS function evaluations=341
  total number of nonlinear solver iterations=3215
  total number of linear solver iterations=-1031539776
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 18, t=7573.824000. [0:00:00:00]
     Actual time: 24 years, Desired time: 24 years
  Field 0 Min/Max -0.021412/-0.000005
  Field 1 Min/Max 0.868813/0.868813
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 19, t=8204.976000. [0:00:00:00]
     Actual time: 26 years, Desired time: 26 years
  Field 0 Min/Max -0.021576/-0.000005
  Field 1 Min/Max 0.868801/0.868801
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 20, t=8836.128000. [0:00:00:00]
     Actual time: 28 years, Desired time: 28 years
  Field 0 Min/Max -0.021741/-0.000005
  Field 1 Min/Max 0.868789/0.868789
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20797.414501848918 F_int: 20775.71484375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 15, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-49-07
LOOP: {'total': 15, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 2.8e-05
T_s [K]: 2708.4162417452153
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0    9    Interior  2708.884310  20815.748233  20794.095703  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0    9  Atmosphere  2708.884310  20815.748233  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10    Interior  2708.859703  20814.435812  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10  Atmosphere  2708.859703  20814.435812  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16    Interior  2708.711979  20813.140609  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16  Atmosphere  2708.711979  20813.140609  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22    Interior  2708.564160  20805.278361  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22  Atmosphere  2708.564160  20805.278361  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28    Interior  2708.416242  20797.414502  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28  Atmosphere  2708.416242  20797.414502  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20797.414501848918
F_atm [W/m^2]: 20767.822265625
F_net [W/m^2]: -1.0
Last file name: 28.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 1, 2, 3, 4, 5, 6, 8, 12, 18, 28]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999972.0 5.0 23
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 16, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20767.822265625
    -teqm
    623.9013820228496
    -nstepsmacro
    23
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//28.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     23             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 8836.128000, Will perform 23 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 20, t=8836.128000. [0:00:00:00]
     Actual time: 28 years, Desired time: 28 years
  Field 0 Min/Max -0.021741/-0.000005
  Field 1 Min/Max 0.868789/0.868789
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 66
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93941037328576
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=9467.28
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2907
  total number of linear solver iterations=1512563648
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 21, t=9467.280000. [0:00:00:00]
     Actual time: 30 years, Desired time: 30 years
  Field 0 Min/Max -0.021908/-0.000005
  Field 1 Min/Max 0.868777/0.868777
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 22, t=10098.432000. [0:00:00:00]
     Actual time: 32 years, Desired time: 32 years
  Field 0 Min/Max -0.022075/-0.000005
  Field 1 Min/Max 0.868765/0.868765
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 23, t=10729.584000. [0:00:00:00]
     Actual time: 34 years, Desired time: 34 years
  Field 0 Min/Max -0.022244/-0.000005
  Field 1 Min/Max 0.868753/0.868753
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20789.53534624122 F_int: 20767.822265625
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 16, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-49-39
LOOP: {'total': 16, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 3.4e-05
T_s [K]: 2708.268221195962
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   10    Interior  2708.859703  20814.435812  20792.781250  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   10  Atmosphere  2708.859703  20814.435812  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16    Interior  2708.711979  20813.140609  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16  Atmosphere  2708.711979  20813.140609  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22    Interior  2708.564160  20805.278361  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22  Atmosphere  2708.564160  20805.278361  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28    Interior  2708.416242  20797.414502  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28  Atmosphere  2708.416242  20797.414502  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34    Interior  2708.268221  20789.535346  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34  Atmosphere  2708.268221  20789.535346  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20789.53534624122
F_atm [W/m^2]: 20759.935546875
F_net [W/m^2]: -1.0
Last file name: 34.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 2, 2, 3, 4, 6, 7, 10, 16, 24, 34]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999966.0 5.0 26
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 17, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20759.935546875
    -teqm
    623.9013764729294
    -nstepsmacro
    26
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//34.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     26             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 10729.584000, Will perform 26 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 23, t=10729.584000. [0:00:00:00]
     Actual time: 34 years, Desired time: 34 years
  Field 0 Min/Max -0.022244/-0.000005
  Field 1 Min/Max 0.868753/0.868753
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 67
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94588759738560
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=11360.7
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2927
  total number of linear solver iterations=694911936
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 24, t=11360.736000. [0:00:00:00]
     Actual time: 36 years, Desired time: 36 years
  Field 0 Min/Max -0.022415/-0.000005
  Field 1 Min/Max 0.868741/0.868741
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 25, t=11991.888000. [0:00:00:00]
     Actual time: 38 years, Desired time: 38 years
  Field 0 Min/Max -0.022586/-0.000005
  Field 1 Min/Max 0.868729/0.868729
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 26, t=12623.040000. [0:00:00:00]
     Actual time: 40 years, Desired time: 40 years
  Field 0 Min/Max -0.022759/-0.000005
  Field 1 Min/Max 0.868717/0.868717
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20781.66240555476 F_int: 20759.935546875004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 17, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-50-12
LOOP: {'total': 17, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 4e-05
T_s [K]: 2708.120096145016
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   16    Interior  2708.711979  20813.140609  20791.466797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   16  Atmosphere  2708.711979  20813.140609  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22    Interior  2708.564160  20805.278361  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22  Atmosphere  2708.564160  20805.278361  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28    Interior  2708.416242  20797.414502  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28  Atmosphere  2708.416242  20797.414502  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34    Interior  2708.268221  20789.535346  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34  Atmosphere  2708.268221  20789.535346  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40    Interior  2708.120096  20781.662406  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40  Atmosphere  2708.120096  20781.662406  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20781.66240555476
F_atm [W/m^2]: 20752.041015625
F_net [W/m^2]: -1.0
Last file name: 40.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 2, 3, 4, 5, 6, 8, 12, 18, 28, 40]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999960.0 5.0 29
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 18, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20752.041015625
    -teqm
    623.901370923009
    -nstepsmacro
    29
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//40.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     29             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 12623.040000, Will perform 29 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 26, t=12623.040000. [0:00:00:00]
     Actual time: 40 years, Desired time: 40 years
  Field 0 Min/Max -0.022759/-0.000005
  Field 1 Min/Max 0.868717/0.868717
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 66
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94013217601728
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=13254.2
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2907
  total number of linear solver iterations=678392768
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 27, t=13254.192000. [0:00:00:00]
     Actual time: 42 years, Desired time: 42 years
  Field 0 Min/Max -0.022934/-0.000005
  Field 1 Min/Max 0.868705/0.868705
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 28, t=13885.344000. [0:00:00:00]
     Actual time: 44 years, Desired time: 44 years
  Field 0 Min/Max -0.023109/-0.000004
  Field 1 Min/Max 0.868694/0.868694
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 29, t=14516.496000. [0:00:00:00]
     Actual time: 46 years, Desired time: 46 years
  Field 0 Min/Max -0.023286/-0.000004
  Field 1 Min/Max 0.868682/0.868682
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20773.781998841325 F_int: 20752.041015625
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 18, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-50-42
LOOP: {'total': 18, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 4.6e-05
T_s [K]: 2707.97186421375
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   22    Interior  2708.564160  20805.278361  20783.591797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   22  Atmosphere  2708.564160  20805.278361  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28    Interior  2708.416242  20797.414502  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28  Atmosphere  2708.416242  20797.414502  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34    Interior  2708.268221  20789.535346  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34  Atmosphere  2708.268221  20789.535346  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40    Interior  2708.120096  20781.662406  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40  Atmosphere  2708.120096  20781.662406  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46    Interior  2707.971864  20773.781999  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46  Atmosphere  2707.971864  20773.781999  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20773.781998841325
F_atm [W/m^2]: 20744.140625
F_net [W/m^2]: -1.0
Last file name: 46.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 2, 3, 4, 6, 7, 10, 14, 22, 32, 46]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999954.0 5.0 32
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 19, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20744.140625
    -teqm
    623.9013653730885
    -nstepsmacro
    32
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//46.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     32             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 14516.496000, Will perform 32 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 29, t=14516.496000. [0:00:00:00]
     Actual time: 46 years, Desired time: 46 years
  Field 0 Min/Max -0.023286/-0.000004
  Field 1 Min/Max 0.868682/0.868682
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 69
  SUNDIALS no. of calls to rhs function 83
  SUNDIALS no. of calls to linear solver setup function 23
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 82
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93953270552768
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=15147.6
  total number of RHS function evaluations=339
  total number of nonlinear solver iterations=3084
  total number of linear solver iterations=860885952
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 30, t=15147.648000. [0:00:00:00]
     Actual time: 48 years, Desired time: 48 years
  Field 0 Min/Max -0.023465/-0.000004
  Field 1 Min/Max 0.868670/0.868670
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 31, t=15778.800000. [0:00:00:00]
     Actual time: 50 years, Desired time: 50 years
  Field 0 Min/Max -0.023644/-0.000004
  Field 1 Min/Max 0.868658/0.868658
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 32, t=16409.952000. [0:00:00:00]
     Actual time: 52 years, Desired time: 52 years
  Field 0 Min/Max -0.023826/-0.000004
  Field 1 Min/Max 0.868646/0.868646
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20765.896084526394 F_int: 20744.140624999996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 19, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-51-14
LOOP: {'total': 19, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 5.2e-05
T_s [K]: 2707.8235230227556
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   28    Interior  2708.416242  20797.414502  20775.714844  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   28  Atmosphere  2708.416242  20797.414502  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34    Interior  2708.268221  20789.535346  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34  Atmosphere  2708.268221  20789.535346  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40    Interior  2708.120096  20781.662406  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40  Atmosphere  2708.120096  20781.662406  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46    Interior  2707.971864  20773.781999  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46  Atmosphere  2707.971864  20773.781999  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52    Interior  2707.823523  20765.896085  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52  Atmosphere  2707.823523  20765.896085  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20765.896084526394
F_atm [W/m^2]: 20736.23828125
F_net [W/m^2]: -1.0
Last file name: 52.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 3, 4, 5, 6, 8, 12, 18, 26, 38, 52]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999948.0 5.0 35
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 20, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20736.23828125
    -teqm
    623.9013598231677
    -nstepsmacro
    35
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//52.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     35             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 16409.952000, Will perform 35 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 32, t=16409.952000. [0:00:00:00]
     Actual time: 52 years, Desired time: 52 years
  Field 0 Min/Max -0.023826/-0.000004
  Field 1 Min/Max 0.868646/0.868646
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 66
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94841724655808
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=17041.1
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2907
  total number of linear solver iterations=256758720
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 33, t=17041.104000. [0:00:00:00]
     Actual time: 54 years, Desired time: 54 years
  Field 0 Min/Max -0.024008/-0.000004
  Field 1 Min/Max 0.868634/0.868634
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 34, t=17672.256000. [0:00:00:00]
     Actual time: 56 years, Desired time: 56 years
  Field 0 Min/Max -0.024192/-0.000004
  Field 1 Min/Max 0.868622/0.868622
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 35, t=18303.408000. [0:00:00:00]
     Actual time: 58 years, Desired time: 58 years
  Field 0 Min/Max -0.024377/-0.000004
  Field 1 Min/Max 0.868610/0.868610
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20758.00856718907 F_int: 20736.238281249996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 20, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-51-47
LOOP: {'total': 20, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 5.8e-05
T_s [K]: 2707.6750701002584
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   34    Interior  2708.268221  20789.535346  20767.822266  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   34  Atmosphere  2708.268221  20789.535346  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40    Interior  2708.120096  20781.662406  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40  Atmosphere  2708.120096  20781.662406  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46    Interior  2707.971864  20773.781999  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46  Atmosphere  2707.971864  20773.781999  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52    Interior  2707.823523  20765.896085  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52  Atmosphere  2707.823523  20765.896085  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58    Interior  2707.675070  20758.008567  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58  Atmosphere  2707.675070  20758.008567  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20758.00856718907
F_atm [W/m^2]: 20728.27734375
F_net [W/m^2]: -1.0
Last file name: 58.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 3, 4, 5, 7, 9, 14, 20, 30, 42, 58]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999942.0 5.0 38
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 21, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20728.27734375
    -teqm
    623.901354273247
    -nstepsmacro
    38
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//58.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     38             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 18303.408000, Will perform 38 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 35, t=18303.408000. [0:00:00:00]
     Actual time: 58 years, Desired time: 58 years
  Field 0 Min/Max -0.024377/-0.000004
  Field 1 Min/Max 0.868610/0.868610
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 69
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 23
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94142242273472
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=18934.6
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=3084
  total number of linear solver iterations=854045632
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 36, t=18934.560000. [0:00:00:00]
     Actual time: 60 years, Desired time: 60 years
  Field 0 Min/Max -0.024564/-0.000004
  Field 1 Min/Max 0.868598/0.868598
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 37, t=19565.712000. [0:00:00:00]
     Actual time: 62 years, Desired time: 62 years
  Field 0 Min/Max -0.024752/-0.000004
  Field 1 Min/Max 0.868586/0.868586
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 38, t=20196.864000. [0:00:00:00]
     Actual time: 64 years, Desired time: 64 years
  Field 0 Min/Max -0.024942/-0.000004
  Field 1 Min/Max 0.868574/0.868574
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20750.062758437485 F_int: 20728.27734375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 21, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-52-17
LOOP: {'total': 21, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 6.4e-05
T_s [K]: 2707.5265034324425
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   40    Interior  2708.120096  20781.662406  20759.935547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   40  Atmosphere  2708.120096  20781.662406  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46    Interior  2707.971864  20773.781999  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46  Atmosphere  2707.971864  20773.781999  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52    Interior  2707.823523  20765.896085  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52  Atmosphere  2707.823523  20765.896085  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58    Interior  2707.675070  20758.008567  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58  Atmosphere  2707.675070  20758.008567  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64    Interior  2707.526503  20750.062758  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64  Atmosphere  2707.526503  20750.062758  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20750.062758437485
F_atm [W/m^2]: 20720.373046875
F_net [W/m^2]: -1.0
Last file name: 64.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 3, 4, 6, 7, 10, 16, 24, 34, 46, 64]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999936.0 5.0 41
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 22, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20720.373046875
    -teqm
    623.9013487233259
    -nstepsmacro
    41
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//64.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     41             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 20196.864000, Will perform 41 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 38, t=20196.864000. [0:00:00:00]
     Actual time: 64 years, Desired time: 64 years
  Field 0 Min/Max -0.024942/-0.000004
  Field 1 Min/Max 0.868574/0.868574
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 66
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93951489292480
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=20828.
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2907
  total number of linear solver iterations=-920374336
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 39, t=20828.016000. [0:00:00:00]
     Actual time: 66 years, Desired time: 66 years
  Field 0 Min/Max -0.025133/-0.000004
  Field 1 Min/Max 0.868562/0.868562
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 40, t=21459.168000. [0:00:00:00]
     Actual time: 68 years, Desired time: 68 years
  Field 0 Min/Max -0.025326/-0.000004
  Field 1 Min/Max 0.868550/0.868550
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 41, t=22090.320000. [0:00:00:00]
     Actual time: 70 years, Desired time: 70 years
  Field 0 Min/Max -0.025520/-0.000004
  Field 1 Min/Max 0.868538/0.868538
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20742.174014836433 F_int: 20720.373046875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 22, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-52-46
LOOP: {'total': 22, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 7e-05
T_s [K]: 2707.377820038064
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   46    Interior  2707.971864  20773.781999  20752.041016  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   46  Atmosphere  2707.971864  20773.781999  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52    Interior  2707.823523  20765.896085  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52  Atmosphere  2707.823523  20765.896085  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58    Interior  2707.675070  20758.008567  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58  Atmosphere  2707.675070  20758.008567  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64    Interior  2707.526503  20750.062758  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64  Atmosphere  2707.526503  20750.062758  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70    Interior  2707.377820  20742.174015  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70  Atmosphere  2707.377820  20742.174015  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20742.174014836433
F_atm [W/m^2]: 20712.458984375
F_net [W/m^2]: -1.0
Last file name: 70.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 4, 5, 6, 8, 12, 18, 26, 36, 50, 70]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999930.0 5.0 44
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 23, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20712.458984375
    -teqm
    623.9013431734048
    -nstepsmacro
    44
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//70.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     44             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 22090.320000, Will perform 44 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 41, t=22090.320000. [0:00:00:00]
     Actual time: 70 years, Desired time: 70 years
  Field 0 Min/Max -0.025520/-0.000004
  Field 1 Min/Max 0.868538/0.868538
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 68
  SUNDIALS no. of calls to rhs function 89
  SUNDIALS no. of calls to linear solver setup function 24
  SUNDIALS no. of error test failures 3
  SUNDIALS no. of nonlinear solver iterations 88
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93949200902336
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=22721.5
  total number of RHS function evaluations=345
  total number of nonlinear solver iterations=3109
  total number of linear solver iterations=1086202816
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 42, t=22721.472000. [0:00:00:00]
     Actual time: 72 years, Desired time: 72 years
  Field 0 Min/Max -0.025716/-0.000004
  Field 1 Min/Max 0.868526/0.868526
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 43, t=23352.624000. [0:00:00:00]
     Actual time: 74 years, Desired time: 74 years
  Field 0 Min/Max -0.025913/-0.000004
  Field 1 Min/Max 0.868514/0.868514
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 44, t=23983.776000. [0:00:00:00]
     Actual time: 76 years, Desired time: 76 years
  Field 0 Min/Max -0.026112/-0.000004
  Field 1 Min/Max 0.868502/0.868502
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20734.275861865644 F_int: 20712.458984375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 23, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-53-18
LOOP: {'total': 23, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 7.6e-05
T_s [K]: 2707.2290175185294
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   52    Interior  2707.823523  20765.896085  20744.140625  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   52  Atmosphere  2707.823523  20765.896085  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58    Interior  2707.675070  20758.008567  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58  Atmosphere  2707.675070  20758.008567  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64    Interior  2707.526503  20750.062758  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64  Atmosphere  2707.526503  20750.062758  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70    Interior  2707.377820  20742.174015  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70  Atmosphere  2707.377820  20742.174015  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76    Interior  2707.229018  20734.275862  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76  Atmosphere  2707.229018  20734.275862  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20734.275861865644
F_atm [W/m^2]: 20704.46875
F_net [W/m^2]: -1.0
Last file name: 76.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 4, 5, 7, 9, 12, 20, 28, 40, 56, 76]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999924.0 5.0 47
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 24, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20704.46875
    -teqm
    623.9013376234835
    -nstepsmacro
    47
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//76.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     47             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 23983.776000, Will perform 47 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 44, t=23983.776000. [0:00:00:00]
     Actual time: 76 years, Desired time: 76 years
  Field 0 Min/Max -0.026112/-0.000004
  Field 1 Min/Max 0.868502/0.868502
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 66
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94197362854080
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=24614.9
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2907
  total number of linear solver iterations=140051392
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 45, t=24614.928000. [0:00:00:00]
     Actual time: 78 years, Desired time: 78 years
  Field 0 Min/Max -0.026312/-0.000004
  Field 1 Min/Max 0.868490/0.868490
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 46, t=25246.080000. [0:00:00:00]
     Actual time: 80 years, Desired time: 80 years
  Field 0 Min/Max -0.026514/-0.000004
  Field 1 Min/Max 0.868478/0.868478
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 47, t=25877.232000. [0:00:00:00]
     Actual time: 82 years, Desired time: 82 years
  Field 0 Min/Max -0.026717/-0.000004
  Field 1 Min/Max 0.868466/0.868466
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20726.30182454952 F_int: 20704.46875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 24, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-53-49
LOOP: {'total': 24, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 8.2e-05
T_s [K]: 2707.080093892971
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   58    Interior  2707.675070  20758.008567  20736.238281  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   58  Atmosphere  2707.675070  20758.008567  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64    Interior  2707.526503  20750.062758  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64  Atmosphere  2707.526503  20750.062758  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70    Interior  2707.377820  20742.174015  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70  Atmosphere  2707.377820  20742.174015  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76    Interior  2707.229018  20734.275862  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76  Atmosphere  2707.229018  20734.275862  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82    Interior  2707.080094  20726.301825  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82  Atmosphere  2707.080094  20726.301825  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20726.30182454952
F_atm [W/m^2]: 20696.54296875
F_net [W/m^2]: -1.0
Last file name: 82.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 4, 5, 7, 9, 14, 22, 32, 44, 60, 82]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999918.0 5.0 50
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 25, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20696.54296875
    -teqm
    623.9013320735621
    -nstepsmacro
    50
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//82.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     50             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 25877.232000, Will perform 50 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 47, t=25877.232000. [0:00:00:00]
     Actual time: 82 years, Desired time: 82 years
  Field 0 Min/Max -0.026717/-0.000004
  Field 1 Min/Max 0.868466/0.868466
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 69
  SUNDIALS no. of calls to rhs function 83
  SUNDIALS no. of calls to linear solver setup function 23
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 82
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94652843993280
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=26508.4
  total number of RHS function evaluations=339
  total number of nonlinear solver iterations=3084
  total number of linear solver iterations=354657216
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 48, t=26508.384000. [0:00:00:00]
     Actual time: 84 years, Desired time: 84 years
  Field 0 Min/Max -0.026922/-0.000004
  Field 1 Min/Max 0.868454/0.868454
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 49, t=27139.536000. [0:00:00:00]
     Actual time: 86 years, Desired time: 86 years
  Field 0 Min/Max -0.027129/-0.000004
  Field 1 Min/Max 0.868442/0.868442
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 50, t=27770.688000. [0:00:00:00]
     Actual time: 88 years, Desired time: 88 years
  Field 0 Min/Max -0.027337/-0.000004
  Field 1 Min/Max 0.868430/0.868430
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20718.39268194825 F_int: 20696.542968749996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 25, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-54-22
LOOP: {'total': 25, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 8.8e-05
T_s [K]: 2706.93104610166
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   64    Interior  2707.526503  20750.062758  20728.277344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   64  Atmosphere  2707.526503  20750.062758  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70    Interior  2707.377820  20742.174015  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70  Atmosphere  2707.377820  20742.174015  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76    Interior  2707.229018  20734.275862  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76  Atmosphere  2707.229018  20734.275862  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82    Interior  2707.080094  20726.301825  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82  Atmosphere  2707.080094  20726.301825  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88    Interior  2706.931046  20718.392682  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88  Atmosphere  2706.931046  20718.392682  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20718.39268194825
F_atm [W/m^2]: 20688.609375
F_net [W/m^2]: -1.0
Last file name: 88.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 4, 6, 8, 10, 16, 24, 34, 48, 64, 88]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999912.0 5.0 53
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 26, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20688.609375
    -teqm
    623.9013265236406
    -nstepsmacro
    53
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//88.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     53             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 27770.688000, Will perform 53 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 50, t=27770.688000. [0:00:00:00]
     Actual time: 88 years, Desired time: 88 years
  Field 0 Min/Max -0.027337/-0.000004
  Field 1 Min/Max 0.868430/0.868430
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 66
  SUNDIALS no. of calls to rhs function 82
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 81
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94870245214400
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=28401.8
  total number of RHS function evaluations=338
  total number of nonlinear solver iterations=2907
  total number of linear solver iterations=-1287453760
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 51, t=28401.840000. [0:00:00:00]
     Actual time: 90 years, Desired time: 90 years
  Field 0 Min/Max -0.027546/-0.000004
  Field 1 Min/Max 0.868418/0.868418
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 52, t=29032.992000. [0:00:00:00]
     Actual time: 92 years, Desired time: 92 years
  Field 0 Min/Max -0.027758/-0.000004
  Field 1 Min/Max 0.868406/0.868406
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 53, t=29664.144000. [0:00:00:00]
     Actual time: 94 years, Desired time: 94 years
  Field 0 Min/Max -0.027971/-0.000004
  Field 1 Min/Max 0.868394/0.868394
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20710.476088393516 F_int: 20688.609375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 26, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-54-52
LOOP: {'total': 26, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 9.4e-05
T_s [K]: 2706.7818716400493
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   70    Interior  2707.377820  20742.174015  20720.373047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   70  Atmosphere  2707.377820  20742.174015  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76    Interior  2707.229018  20734.275862  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76  Atmosphere  2707.229018  20734.275862  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82    Interior  2707.080094  20726.301825  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82  Atmosphere  2707.080094  20726.301825  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88    Interior  2706.931046  20718.392682  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88  Atmosphere  2706.931046  20718.392682  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94    Interior  2706.781872  20710.476088  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94  Atmosphere  2706.781872  20710.476088  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20710.476088393516
F_atm [W/m^2]: 20680.677734375
F_net [W/m^2]: -1.0
Last file name: 94.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 5, 6, 8, 12, 18, 26, 38, 52, 70, 94]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
2 5 4566999906.0 5.0 56
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 27, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20680.677734375
    -teqm
    623.9013209737188
    -nstepsmacro
    56
    -dtmacro
    2
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//94.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         631.152         6.31152e+07     s
nstepsmacro     56             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 29664.144000, Will perform 56 macro (output) steps of length 631.152000 = 2.000000 years
***  Writing output at macro Step 53, t=29664.144000. [0:00:00:00]
     Actual time: 94 years, Desired time: 94 years
  Field 0 Min/Max -0.027971/-0.000004
  Field 1 Min/Max 0.868394/0.868394
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 71
  SUNDIALS no. of calls to rhs function 84
  SUNDIALS no. of calls to linear solver setup function 22
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 83
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94137504311488
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 53
  maximum steps=100000000
  maximum time=30295.3
  total number of RHS function evaluations=340
  total number of nonlinear solver iterations=3242
  total number of linear solver iterations=411050944
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 54, t=30295.296000. [0:00:00:00]
     Actual time: 96 years, Desired time: 96 years
  Field 0 Min/Max -0.028185/-0.000004
  Field 1 Min/Max 0.868382/0.868382
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 55, t=30926.448000. [0:00:00:00]
     Actual time: 98 years, Desired time: 98 years
  Field 0 Min/Max -0.028402/-0.000004
  Field 1 Min/Max 0.868370/0.868370
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 56, t=31557.600000. [0:00:00:00]
     Actual time: 100 years, Desired time: 100 years
  Field 0 Min/Max -0.028620/-0.000004
  Field 1 Min/Max 0.868358/0.868358
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20702.561826084086 F_int: 20680.677734375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 27, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-55-23
LOOP: {'total': 27, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0001
T_s [K]: 2706.632567925118
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   76    Interior  2707.229018  20734.275862  20712.458984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   76  Atmosphere  2707.229018  20734.275862  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82    Interior  2707.080094  20726.301825  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82  Atmosphere  2707.080094  20726.301825  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88    Interior  2706.931046  20718.392682  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88  Atmosphere  2706.931046  20718.392682  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94    Interior  2706.781872  20710.476088  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94  Atmosphere  2706.781872  20710.476088  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100    Interior  2706.632568  20702.561826  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100  Atmosphere  2706.632568  20702.561826  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20702.561826084086
F_atm [W/m^2]: 20672.7265625
F_net [W/m^2]: -1.0
Last file name: 100.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 5, 7, 9, 12, 20, 28, 40, 54, 74, 100]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999900.0 50.0 61
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 28, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20672.7265625
    -teqm
    623.901315423797
    -nstepsmacro
    61
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//100.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     61             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 31557.600000, Will perform 61 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 56, t=31557.600000. [0:00:00:00]
     Actual time: 100 years, Desired time: 100 years
  Field 0 Min/Max -0.028620/-0.000004
  Field 1 Min/Max 0.868358/0.868358
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 74
  SUNDIALS no. of calls to rhs function 93
  SUNDIALS no. of calls to linear solver setup function 24
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 92
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94140115327168
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 52
  maximum steps=100000000
  maximum time=34713.4
  total number of RHS function evaluations=349
  total number of nonlinear solver iterations=3606
  total number of linear solver iterations=-1272900672
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 57, t=34713.360000. [0:00:00:00]
     Actual time: 110 years, Desired time: 110 years
  Field 0 Min/Max -0.029735/-0.000004
  Field 1 Min/Max 0.868298/0.868298
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 58, t=37869.120000. [0:00:00:00]
     Actual time: 120 years, Desired time: 120 years
  Field 0 Min/Max -0.030896/-0.000004
  Field 1 Min/Max 0.868238/0.868238
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 59, t=41024.880000. [0:00:00:00]
     Actual time: 130 years, Desired time: 130 years
  Field 0 Min/Max -0.032103/-0.000004
  Field 1 Min/Max 0.868177/0.868177
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 60, t=44180.640000. [0:00:00:00]
     Actual time: 140 years, Desired time: 140 years
  Field 0 Min/Max -0.033358/-0.000004
  Field 1 Min/Max 0.868117/0.868117
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 61, t=47336.400000. [0:00:00:00]
     Actual time: 150 years, Desired time: 150 years
  Field 0 Min/Max -0.034664/-0.000003
  Field 1 Min/Max 0.868056/0.868056
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20694.832829889954 F_int: 20672.7265625
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 28, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-55-53
LOOP: {'total': 28, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00015
T_s [K]: 2705.3811958685965
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   82    Interior  2707.080094  20726.301825  20704.468750  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   82  Atmosphere  2707.080094  20726.301825  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88    Interior  2706.931046  20718.392682  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88  Atmosphere  2706.931046  20718.392682  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94    Interior  2706.781872  20710.476088  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94  Atmosphere  2706.781872  20710.476088  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100    Interior  2706.632568  20702.561826  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100  Atmosphere  2706.632568  20702.561826  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150    Interior  2705.381196  20694.832830  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150  Atmosphere  2705.381196  20694.832830  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20694.832829889954
F_atm [W/m^2]: 20604.009765625
F_net [W/m^2]: -1.0
Last file name: 150.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 6, 7, 10, 14, 22, 32, 44, 60, 82, 150]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999850.0 50.0 66
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 29, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20604.009765625
    -teqm
    623.9012691744423
    -nstepsmacro
    66
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//150.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     66             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 47336.400000, Will perform 66 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 61, t=47336.400000. [0:00:00:00]
     Actual time: 150 years, Desired time: 150 years
  Field 0 Min/Max -0.034664/-0.000003
  Field 1 Min/Max 0.868056/0.868056
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 107
  SUNDIALS no. of calls to rhs function 128
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 127
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94525317216448
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=50492.2
  total number of RHS function evaluations=448
  total number of nonlinear solver iterations=7150
  total number of linear solver iterations=1676899264
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 62, t=50492.160000. [0:00:00:00]
     Actual time: 160 years, Desired time: 160 years
  Field 0 Min/Max -0.036018/-0.000003
  Field 1 Min/Max 0.867995/0.867995
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 63, t=53647.920000. [0:00:00:00]
     Actual time: 170 years, Desired time: 170 years
  Field 0 Min/Max -0.037426/-0.000003
  Field 1 Min/Max 0.867935/0.867935
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 64, t=56803.680000. [0:00:00:00]
     Actual time: 180 years, Desired time: 180 years
  Field 0 Min/Max -0.038891/-0.000003
  Field 1 Min/Max 0.867874/0.867874
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 65, t=59959.440000. [0:00:00:00]
     Actual time: 190 years, Desired time: 190 years
  Field 0 Min/Max -0.040414/-0.000003
  Field 1 Min/Max 0.867813/0.867813
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 66, t=63115.200000. [0:00:00:00]
     Actual time: 200 years, Desired time: 200 years
  Field 0 Min/Max -0.041999/-0.000003
  Field 1 Min/Max 0.867751/0.867751
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20626.300790032124 F_int: 20604.009765624996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 29, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-56-26
LOOP: {'total': 29, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0002
T_s [K]: 2704.119276170126
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   88    Interior  2706.931046  20718.392682  20696.542969  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   88  Atmosphere  2706.931046  20718.392682  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94    Interior  2706.781872  20710.476088  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94  Atmosphere  2706.781872  20710.476088  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100    Interior  2706.632568  20702.561826  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100  Atmosphere  2706.632568  20702.561826  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150    Interior  2705.381196  20694.832830  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150  Atmosphere  2705.381196  20694.832830  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200    Interior  2704.119276  20626.300790  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200  Atmosphere  2704.119276  20626.300790  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20626.300790032124
F_atm [W/m^2]: 20534.185546875
F_net [W/m^2]: -1.0
Last file name: 200.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 6, 8, 10, 18, 26, 36, 50, 66, 90, 200]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999800.0 50.0 71
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 30, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20534.185546875
    -teqm
    623.9012229250773
    -nstepsmacro
    71
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//200.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     71             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 63115.200000, Will perform 71 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 66, t=63115.200000. [0:00:00:00]
     Actual time: 200 years, Desired time: 200 years
  Field 0 Min/Max -0.041999/-0.000003
  Field 1 Min/Max 0.867751/0.867751
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 107
  SUNDIALS no. of calls to rhs function 128
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 127
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94514184829120
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=66271.
  total number of RHS function evaluations=448
  total number of nonlinear solver iterations=7150
  total number of linear solver iterations=-865553472
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 67, t=66270.960000. [0:00:00:00]
     Actual time: 210 years, Desired time: 210 years
  Field 0 Min/Max -0.043642/-0.000003
  Field 1 Min/Max 0.867690/0.867690
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 68, t=69426.720000. [0:00:00:00]
     Actual time: 220 years, Desired time: 220 years
  Field 0 Min/Max -0.045350/-0.000003
  Field 1 Min/Max 0.867629/0.867629
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 69, t=72582.480000. [0:00:00:00]
     Actual time: 230 years, Desired time: 230 years
  Field 0 Min/Max -0.047128/-0.000003
  Field 1 Min/Max 0.867567/0.867567
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 70, t=75738.240000. [0:00:00:00]
     Actual time: 240 years, Desired time: 240 years
  Field 0 Min/Max -0.048976/-0.000003
  Field 1 Min/Max 0.867506/0.867506
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 71, t=78894.000000. [0:00:00:00]
     Actual time: 250 years, Desired time: 250 years
  Field 0 Min/Max -0.050899/-0.000003
  Field 1 Min/Max 0.867444/0.867444
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20556.68663108676 F_int: 20534.185546875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 30, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-56-59
LOOP: {'total': 30, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00025
T_s [K]: 2702.8453038243038
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   94    Interior  2706.781872  20710.476088  20688.609375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   94  Atmosphere  2706.781872  20710.476088  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100    Interior  2706.632568  20702.561826  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100  Atmosphere  2706.632568  20702.561826  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150    Interior  2705.381196  20694.832830  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150  Atmosphere  2705.381196  20694.832830  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200    Interior  2704.119276  20626.300790  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200  Atmosphere  2704.119276  20626.300790  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250    Interior  2702.845304  20556.686631  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250  Atmosphere  2702.845304  20556.686631  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20556.68663108676
F_atm [W/m^2]: 20463.537109375
F_net [W/m^2]: -1.0
Last file name: 250.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 7, 9, 12, 20, 28, 40, 54, 72, 98, 250]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999750.0 50.0 76
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 31, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20463.537109375
    -teqm
    623.901176675702
    -nstepsmacro
    76
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//250.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     76             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 78894.000000, Will perform 76 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 71, t=78894.000000. [0:00:00:00]
     Actual time: 250 years, Desired time: 250 years
  Field 0 Min/Max -0.050899/-0.000003
  Field 1 Min/Max 0.867444/0.867444
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 131
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 130
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94255641942208
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=82049.8
  total number of RHS function evaluations=451
  total number of nonlinear solver iterations=7577
  total number of linear solver iterations=-1710402624
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 72, t=82049.760000. [0:00:00:00]
     Actual time: 260 years, Desired time: 260 years
  Field 0 Min/Max -0.052892/-0.000003
  Field 1 Min/Max 0.867382/0.867382
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 73, t=85205.520000. [0:00:00:00]
     Actual time: 270 years, Desired time: 270 years
  Field 0 Min/Max -0.054964/-0.000002
  Field 1 Min/Max 0.867320/0.867320
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 74, t=88361.280000. [0:00:00:00]
     Actual time: 280 years, Desired time: 280 years
  Field 0 Min/Max -0.057120/-0.000002
  Field 1 Min/Max 0.867258/0.867258
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 75, t=91517.040000. [0:00:00:00]
     Actual time: 290 years, Desired time: 290 years
  Field 0 Min/Max -0.059361/-0.000002
  Field 1 Min/Max 0.867195/0.867195
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 76, t=94672.800000. [0:00:00:00]
     Actual time: 300 years, Desired time: 300 years
  Field 0 Min/Max -0.061692/-0.000002
  Field 1 Min/Max 0.867133/0.867133
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20486.27218981578 F_int: 20463.537109375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 31, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-57-31
LOOP: {'total': 31, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0003
T_s [K]: 2701.557837701614
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  100    Interior  2706.632568  20702.561826  20680.677734  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  100  Atmosphere  2706.632568  20702.561826  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150    Interior  2705.381196  20694.832830  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150  Atmosphere  2705.381196  20694.832830  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200    Interior  2704.119276  20626.300790  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200  Atmosphere  2704.119276  20626.300790  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250    Interior  2702.845304  20556.686631  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250  Atmosphere  2702.845304  20556.686631  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300    Interior  2701.557838  20486.272190  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300  Atmosphere  2701.557838  20486.272190  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20486.27218981578
F_atm [W/m^2]: 20392.35546875
F_net [W/m^2]: -1.0
Last file name: 300.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 7, 9, 14, 22, 30, 42, 58, 78, 130, 300]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999700.0 50.0 81
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 32, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20392.35546875
    -teqm
    623.9011304263164
    -nstepsmacro
    81
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//300.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     81             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 94672.800000, Will perform 81 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 76, t=94672.800000. [0:00:00:00]
     Actual time: 300 years, Desired time: 300 years
  Field 0 Min/Max -0.061692/-0.000002
  Field 1 Min/Max 0.867133/0.867133
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 107
  SUNDIALS no. of calls to rhs function 127
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 126
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94057340364992
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=97828.6
  total number of RHS function evaluations=447
  total number of nonlinear solver iterations=7149
  total number of linear solver iterations=1851483072
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 77, t=97828.560000. [0:00:00:00]
     Actual time: 310 years, Desired time: 310 years
  Field 0 Min/Max -0.064108/-0.000002
  Field 1 Min/Max 0.867070/0.867070
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 78, t=100984.320000. [0:00:00:00]
     Actual time: 320 years, Desired time: 320 years
  Field 0 Min/Max -0.066619/-0.000002
  Field 1 Min/Max 0.867008/0.867008
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 79, t=104140.080000. [0:00:00:00]
     Actual time: 330 years, Desired time: 330 years
  Field 0 Min/Max -0.069230/-0.000002
  Field 1 Min/Max 0.866945/0.866945
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 80, t=107295.840000. [0:00:00:00]
     Actual time: 340 years, Desired time: 340 years
  Field 0 Min/Max -0.071944/-0.000002
  Field 1 Min/Max 0.866882/0.866882
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 81, t=110451.600000. [0:00:00:00]
     Actual time: 350 years, Desired time: 350 years
  Field 0 Min/Max -0.074765/-0.000002
  Field 1 Min/Max 0.866818/0.866818
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20415.34568801335 F_int: 20392.355468750004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 32, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-58-04
LOOP: {'total': 32, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00035
T_s [K]: 2700.255549729892
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  150    Interior  2705.381196  20694.832830  20672.726562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  150  Atmosphere  2705.381196  20694.832830  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200    Interior  2704.119276  20626.300790  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200  Atmosphere  2704.119276  20626.300790  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250    Interior  2702.845304  20556.686631  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250  Atmosphere  2702.845304  20556.686631  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300    Interior  2701.557838  20486.272190  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300  Atmosphere  2701.557838  20486.272190  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350    Interior  2700.255550  20415.345688  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350  Atmosphere  2700.255550  20415.345688  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20415.34568801335
F_atm [W/m^2]: 20320.3515625
F_net [W/m^2]: -1.0
Last file name: 350.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 8, 10, 16, 24, 34, 46, 64, 84, 160, 350]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999650.0 50.0 86
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 33, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20320.3515625
    -teqm
    623.9010841769206
    -nstepsmacro
    86
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//350.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     86             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 110451.600000, Will perform 86 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 81, t=110451.600000. [0:00:00:00]
     Actual time: 350 years, Desired time: 350 years
  Field 0 Min/Max -0.074765/-0.000002
  Field 1 Min/Max 0.866818/0.866818
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 130
  SUNDIALS no. of calls to linear solver setup function 29
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 129
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94256840190144
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 103
  maximum steps=100000000
  maximum time=113607.
  total number of RHS function evaluations=450
  total number of nonlinear solver iterations=7565
  total number of linear solver iterations=-512154688
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 82, t=113607.360000. [0:00:00:00]
     Actual time: 360 years, Desired time: 360 years
  Field 0 Min/Max -0.077687/-0.000002
  Field 1 Min/Max 0.866755/0.866755
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 83, t=116763.120000. [0:00:00:00]
     Actual time: 370 years, Desired time: 370 years
  Field 0 Min/Max -0.080724/-0.000002
  Field 1 Min/Max 0.866692/0.866692
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 84, t=119918.880000. [0:00:00:00]
     Actual time: 380 years, Desired time: 380 years
  Field 0 Min/Max -0.083880/-0.000002
  Field 1 Min/Max 0.866628/0.866628
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 85, t=123074.640000. [0:00:00:00]
     Actual time: 390 years, Desired time: 390 years
  Field 0 Min/Max -0.087158/-0.000002
  Field 1 Min/Max 0.866564/0.866564
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 86, t=126230.400000. [0:00:00:00]
     Actual time: 400 years, Desired time: 400 years
  Field 0 Min/Max -0.090564/-0.000002
  Field 1 Min/Max 0.866500/0.866500
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20343.61307116572 F_int: 20320.351562500004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 33, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-58-34
LOOP: {'total': 33, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0004
T_s [K]: 2698.9373486302916
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  200    Interior  2704.119276  20626.300790  20604.009766  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  200  Atmosphere  2704.119276  20626.300790  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250    Interior  2702.845304  20556.686631  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250  Atmosphere  2702.845304  20556.686631  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300    Interior  2701.557838  20486.272190  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300  Atmosphere  2701.557838  20486.272190  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350    Interior  2700.255550  20415.345688  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350  Atmosphere  2700.255550  20415.345688  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400    Interior  2698.937349  20343.613071  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400  Atmosphere  2698.937349  20343.613071  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20343.61307116572
F_atm [W/m^2]: 20247.576171875
F_net [W/m^2]: -1.0
Last file name: 400.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 8, 10, 18, 26, 36, 50, 68, 90, 200, 400]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999600.0 50.0 91
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 34, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20247.576171875
    -teqm
    623.9010379275145
    -nstepsmacro
    91
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//400.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     91             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 126230.400000, Will perform 91 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 86, t=126230.400000. [0:00:00:00]
     Actual time: 400 years, Desired time: 400 years
  Field 0 Min/Max -0.090564/-0.000002
  Field 1 Min/Max 0.866500/0.866500
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 132
  SUNDIALS no. of calls to linear solver setup function 29
  SUNDIALS no. of error test failures 3
  SUNDIALS no. of nonlinear solver iterations 131
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93914188490944
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=129386.
  total number of RHS function evaluations=452
  total number of nonlinear solver iterations=7501
  total number of linear solver iterations=433529792
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 87, t=129386.160000. [0:00:00:00]
     Actual time: 410 years, Desired time: 410 years
  Field 0 Min/Max -0.094089/-0.000002
  Field 1 Min/Max 0.866436/0.866436
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 88, t=132541.920000. [0:00:00:00]
     Actual time: 420 years, Desired time: 420 years
  Field 0 Min/Max -0.097750/-0.000002
  Field 1 Min/Max 0.866372/0.866372
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 89, t=135697.680000. [0:00:00:00]
     Actual time: 430 years, Desired time: 430 years
  Field 0 Min/Max -0.101551/-0.000002
  Field 1 Min/Max 0.866307/0.866307
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 90, t=138853.440000. [0:00:00:00]
     Actual time: 440 years, Desired time: 440 years
  Field 0 Min/Max -0.105497/-0.000001
  Field 1 Min/Max 0.866243/0.866243
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 91, t=142009.200000. [0:00:00:00]
     Actual time: 450 years, Desired time: 450 years
  Field 0 Min/Max -0.109592/-0.000001
  Field 1 Min/Max 0.866178/0.866178
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20271.119083758782 F_int: 20247.576171874996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 34, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-59-04
LOOP: {'total': 34, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00045
T_s [K]: 2697.6024445642115
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  250    Interior  2702.845304  20556.686631  20534.185547  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  250  Atmosphere  2702.845304  20556.686631  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300    Interior  2701.557838  20486.272190  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300  Atmosphere  2701.557838  20486.272190  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350    Interior  2700.255550  20415.345688  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350  Atmosphere  2700.255550  20415.345688  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400    Interior  2698.937349  20343.613071  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400  Atmosphere  2698.937349  20343.613071  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450    Interior  2697.602445  20271.119084  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450  Atmosphere  2697.602445  20271.119084  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20271.119083758782
F_atm [W/m^2]: 20174.02734375
F_net [W/m^2]: -1.0
Last file name: 450.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 9, 12, 20, 28, 40, 54, 72, 96, 240, 450]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999550.0 50.0 96
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 35, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20174.02734375
    -teqm
    623.9009916780981
    -nstepsmacro
    96
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//450.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     96             
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 142009.200000, Will perform 96 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 91, t=142009.200000. [0:00:00:00]
     Actual time: 450 years, Desired time: 450 years
  Field 0 Min/Max -0.109592/-0.000001
  Field 1 Min/Max 0.866178/0.866178
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 109
  SUNDIALS no. of calls to rhs function 131
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 3
  SUNDIALS no. of nonlinear solver iterations 130
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94288371144896
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=145165.
  total number of RHS function evaluations=451
  total number of nonlinear solver iterations=7366
  total number of linear solver iterations=954028992
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 92, t=145164.960000. [0:00:00:00]
     Actual time: 460 years, Desired time: 460 years
  Field 0 Min/Max -0.113827/-0.000001
  Field 1 Min/Max 0.866113/0.866113
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 93, t=148320.720000. [0:00:00:00]
     Actual time: 470 years, Desired time: 470 years
  Field 0 Min/Max -0.118219/-0.000001
  Field 1 Min/Max 0.866048/0.866048
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 94, t=151476.480000. [0:00:00:00]
     Actual time: 480 years, Desired time: 480 years
  Field 0 Min/Max -0.122775/-0.000001
  Field 1 Min/Max 0.865983/0.865983
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 95, t=154632.240000. [0:00:00:00]
     Actual time: 490 years, Desired time: 490 years
  Field 0 Min/Max -0.127499/-0.000001
  Field 1 Min/Max 0.865917/0.865917
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 96, t=157788.000000. [0:00:00:00]
     Actual time: 500 years, Desired time: 500 years
  Field 0 Min/Max -0.132396/-0.000001
  Field 1 Min/Max 0.865851/0.865851
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20197.854591765838 F_int: 20174.027343749993
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 35, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_14-59-34
LOOP: {'total': 35, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0005
T_s [K]: 2696.250426385583
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  300    Interior  2701.557838  20486.272190  20463.537109  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  300  Atmosphere  2701.557838  20486.272190  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350    Interior  2700.255550  20415.345688  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350  Atmosphere  2700.255550  20415.345688  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400    Interior  2698.937349  20343.613071  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400  Atmosphere  2698.937349  20343.613071  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450    Interior  2697.602445  20271.119084  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450  Atmosphere  2697.602445  20271.119084  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500    Interior  2696.250426  20197.854592  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500  Atmosphere  2696.250426  20197.854592  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20197.854591765838
F_atm [W/m^2]: 20099.484375
F_net [W/m^2]: -1.0
Last file name: 500.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 9, 14, 20, 30, 42, 58, 78, 110, 280, 500]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999500.0 50.0 101
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 36, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20099.484375
    -teqm
    623.9009454286713
    -nstepsmacro
    101
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//500.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     101            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 157788.000000, Will perform 101 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 96, t=157788.000000. [0:00:00:00]
     Actual time: 500 years, Desired time: 500 years
  Field 0 Min/Max -0.132396/-0.000001
  Field 1 Min/Max 0.865851/0.865851
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 128
  SUNDIALS no. of calls to linear solver setup function 27
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 127
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94727668713664
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 106
  maximum steps=100000000
  maximum time=160944.
  total number of RHS function evaluations=448
  total number of nonlinear solver iterations=7479
  total number of linear solver iterations=-2130033728
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 97, t=160943.760000. [0:00:00:00]
     Actual time: 510 years, Desired time: 510 years
  Field 0 Min/Max -0.137453/-0.000001
  Field 1 Min/Max 0.865786/0.865786
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 98, t=164099.520000. [0:00:00:00]
     Actual time: 520 years, Desired time: 520 years
  Field 0 Min/Max -0.142691/-0.000001
  Field 1 Min/Max 0.865720/0.865720
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 99, t=167255.280000. [0:00:00:00]
     Actual time: 530 years, Desired time: 530 years
  Field 0 Min/Max -0.148116/-0.000001
  Field 1 Min/Max 0.865654/0.865654
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 100, t=170411.040000. [0:00:00:00]
     Actual time: 540 years, Desired time: 540 years
  Field 0 Min/Max -0.153732/-0.000001
  Field 1 Min/Max 0.865587/0.865587
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 101, t=173566.800000. [0:00:00:00]
     Actual time: 550 years, Desired time: 550 years
  Field 0 Min/Max -0.159545/-0.000001
  Field 1 Min/Max 0.865521/0.865521
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20123.590907624886 F_int: 20099.484375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 36, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-00-08
LOOP: {'total': 36, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00055
T_s [K]: 2694.8813251742945
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  350    Interior  2700.255550  20415.345688  20392.355469  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  350  Atmosphere  2700.255550  20415.345688  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400    Interior  2698.937349  20343.613071  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400  Atmosphere  2698.937349  20343.613071  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450    Interior  2697.602445  20271.119084  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450  Atmosphere  2697.602445  20271.119084  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500    Interior  2696.250426  20197.854592  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500  Atmosphere  2696.250426  20197.854592  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550    Interior  2694.881325  20123.590908  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550  Atmosphere  2694.881325  20123.590908  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20123.590907624886
F_atm [W/m^2]: 20024.138671875
F_net [W/m^2]: -1.0
Last file name: 550.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 10, 14, 22, 32, 44, 60, 82, 140, 320, 550]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999450.0 50.0 106
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 37, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    20024.138671875
    -teqm
    623.9008991792344
    -nstepsmacro
    106
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//550.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     106            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 173566.800000, Will perform 106 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 101, t=173566.800000. [0:00:00:00]
     Actual time: 550 years, Desired time: 550 years
  Field 0 Min/Max -0.159545/-0.000001
  Field 1 Min/Max 0.865521/0.865521
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 111
  SUNDIALS no. of calls to rhs function 134
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 3
  SUNDIALS no. of nonlinear solver iterations 133
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94306056358080
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=176723.
  total number of RHS function evaluations=454
  total number of nonlinear solver iterations=7637
  total number of linear solver iterations=1459372992
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 102, t=176722.560000. [0:00:00:00]
     Actual time: 560 years, Desired time: 560 years
  Field 0 Min/Max -0.165536/-0.000001
  Field 1 Min/Max 0.865454/0.865454
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 103, t=179878.320000. [0:00:00:00]
     Actual time: 570 years, Desired time: 570 years
  Field 0 Min/Max -0.171732/-0.000001
  Field 1 Min/Max 0.865388/0.865388
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 104, t=183034.080000. [0:00:00:00]
     Actual time: 580 years, Desired time: 580 years
  Field 0 Min/Max -0.178136/-0.000001
  Field 1 Min/Max 0.865321/0.865321
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 105, t=186189.840000. [0:00:00:00]
     Actual time: 590 years, Desired time: 590 years
  Field 0 Min/Max -0.184753/-0.000001
  Field 1 Min/Max 0.865254/0.865254
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 106, t=189345.600000. [0:00:00:00]
     Actual time: 600 years, Desired time: 600 years
  Field 0 Min/Max -0.191588/-0.000001
  Field 1 Min/Max 0.865186/0.865186
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 20048.512084389073 F_int: 20024.138671875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 37, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-00-40
LOOP: {'total': 37, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0006
T_s [K]: 2693.4955995969253
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  400    Interior  2698.937349  20343.613071  20320.351562  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  400  Atmosphere  2698.937349  20343.613071  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450    Interior  2697.602445  20271.119084  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450  Atmosphere  2697.602445  20271.119084  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500    Interior  2696.250426  20197.854592  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500  Atmosphere  2696.250426  20197.854592  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550    Interior  2694.881325  20123.590908  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550  Atmosphere  2694.881325  20123.590908  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600    Interior  2693.495600  20048.512084  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600  Atmosphere  2693.495600  20048.512084  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 20048.512084389073
F_atm [W/m^2]: 19947.958984375
F_net [W/m^2]: -1.0
Last file name: 600.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 10, 16, 24, 34, 48, 64, 86, 170, 360, 600]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999400.0 50.0 111
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 38, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19947.958984375
    -teqm
    623.9008529297871
    -nstepsmacro
    111
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//600.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     111            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 189345.600000, Will perform 111 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 106, t=189345.600000. [0:00:00:00]
     Actual time: 600 years, Desired time: 600 years
  Field 0 Min/Max -0.191588/-0.000001
  Field 1 Min/Max 0.865186/0.865186
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 130
  SUNDIALS no. of calls to linear solver setup function 27
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 129
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94141022398656
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=192501.
  total number of RHS function evaluations=450
  total number of nonlinear solver iterations=7473
  total number of linear solver iterations=-365829184
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 107, t=192501.360000. [0:00:00:00]
     Actual time: 610 years, Desired time: 610 years
  Field 0 Min/Max -0.198617/-0.000001
  Field 1 Min/Max 0.865119/0.865119
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 108, t=195657.120000. [0:00:00:00]
     Actual time: 620 years, Desired time: 620 years
  Field 0 Min/Max -0.205870/-0.000001
  Field 1 Min/Max 0.865051/0.865051
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 109, t=198812.880000. [0:00:00:00]
     Actual time: 630 years, Desired time: 630 years
  Field 0 Min/Max -0.213350/-0.000001
  Field 1 Min/Max 0.864984/0.864984
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 110, t=201968.640000. [0:00:00:00]
     Actual time: 640 years, Desired time: 640 years
  Field 0 Min/Max -0.221061/-0.000001
  Field 1 Min/Max 0.864916/0.864916
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 111, t=205124.400000. [0:00:00:00]
     Actual time: 650 years, Desired time: 650 years
  Field 0 Min/Max -0.229005/-0.000001
  Field 1 Min/Max 0.864848/0.864848
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19972.58008065842 F_int: 19947.958984375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 38, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-01-13
LOOP: {'total': 38, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00065
T_s [K]: 2692.0941246248403
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  450    Interior  2697.602445  20271.119084  20247.576172  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  450  Atmosphere  2697.602445  20271.119084  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500    Interior  2696.250426  20197.854592  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500  Atmosphere  2696.250426  20197.854592  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550    Interior  2694.881325  20123.590908  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550  Atmosphere  2694.881325  20123.590908  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600    Interior  2693.495600  20048.512084  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600  Atmosphere  2693.495600  20048.512084  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650    Interior  2692.094125  19972.580081  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650  Atmosphere  2692.094125  19972.580081  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19972.58008065842
F_atm [W/m^2]: 19871.01171875
F_net [W/m^2]: -1.0
Last file name: 650.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 12, 18, 26, 36, 50, 68, 92, 200, 400, 650]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999350.0 50.0 116
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 39, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19871.01171875
    -teqm
    623.9008066803295
    -nstepsmacro
    116
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//650.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     116            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 205124.400000, Will perform 116 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 111, t=205124.400000. [0:00:00:00]
     Actual time: 650 years, Desired time: 650 years
  Field 0 Min/Max -0.229005/-0.000001
  Field 1 Min/Max 0.864848/0.864848
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 109
  SUNDIALS no. of calls to rhs function 125
  SUNDIALS no. of calls to linear solver setup function 25
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 124
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94705503189184
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=208280.
  total number of RHS function evaluations=445
  total number of nonlinear solver iterations=7204
  total number of linear solver iterations=1474245568
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 112, t=208280.160000. [0:00:00:00]
     Actual time: 660 years, Desired time: 660 years
  Field 0 Min/Max -0.237154/-0.000001
  Field 1 Min/Max 0.864780/0.864780
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 113, t=211435.920000. [0:00:00:00]
     Actual time: 670 years, Desired time: 670 years
  Field 0 Min/Max -0.245540/-0.000001
  Field 1 Min/Max 0.864712/0.864712
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 114, t=214591.680000. [0:00:00:00]
     Actual time: 680 years, Desired time: 680 years
  Field 0 Min/Max -0.254166/-0.000001
  Field 1 Min/Max 0.864643/0.864643
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 115, t=217747.440000. [0:00:00:00]
     Actual time: 690 years, Desired time: 690 years
  Field 0 Min/Max -0.263032/-0.000001
  Field 1 Min/Max 0.864575/0.864575
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 116, t=220903.200000. [0:00:00:00]
     Actual time: 700 years, Desired time: 700 years
  Field 0 Min/Max -0.272141/-0.000001
  Field 1 Min/Max 0.864506/0.864506
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19895.856009834355 F_int: 19871.01171875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 39, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-01-45
LOOP: {'total': 39, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0007
T_s [K]: 2690.67812213917
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  500    Interior  2696.250426  20197.854592  20174.027344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  500  Atmosphere  2696.250426  20197.854592  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550    Interior  2694.881325  20123.590908  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550  Atmosphere  2694.881325  20123.590908  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600    Interior  2693.495600  20048.512084  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600  Atmosphere  2693.495600  20048.512084  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650    Interior  2692.094125  19972.580081  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650  Atmosphere  2692.094125  19972.580081  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700    Interior  2690.678122  19895.856010  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700  Atmosphere  2690.678122  19895.856010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19895.856009834355
F_atm [W/m^2]: 19793.216796875
F_net [W/m^2]: -1.0
Last file name: 700.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 12, 18, 28, 38, 52, 72, 96, 230, 440, 700]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999300.0 50.0 121
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 40, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19793.216796875
    -teqm
    623.9007604308619
    -nstepsmacro
    121
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//700.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     121            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 220903.200000, Will perform 121 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 116, t=220903.200000. [0:00:00:00]
     Actual time: 700 years, Desired time: 700 years
  Field 0 Min/Max -0.272141/-0.000001
  Field 1 Min/Max 0.864506/0.864506
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 111
  SUNDIALS no. of calls to rhs function 133
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 3
  SUNDIALS no. of nonlinear solver iterations 132
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94091613935808
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 105
  maximum steps=100000000
  maximum time=224059.
  total number of RHS function evaluations=453
  total number of nonlinear solver iterations=7618
  total number of linear solver iterations=1765315520
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 117, t=224058.960000. [0:00:00:00]
     Actual time: 710 years, Desired time: 710 years
  Field 0 Min/Max -0.281457/-0.000001
  Field 1 Min/Max 0.864437/0.864437
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 118, t=227214.720000. [0:00:00:00]
     Actual time: 720 years, Desired time: 720 years
  Field 0 Min/Max -0.291014/-0.000001
  Field 1 Min/Max 0.864368/0.864368
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 119, t=230370.480000. [0:00:00:00]
     Actual time: 730 years, Desired time: 730 years
  Field 0 Min/Max -0.300813/-0.000001
  Field 1 Min/Max 0.864299/0.864299
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 120, t=233526.240000. [0:00:00:00]
     Actual time: 740 years, Desired time: 740 years
  Field 0 Min/Max -0.310854/-0.000001
  Field 1 Min/Max 0.864230/0.864230
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 121, t=236682.000000. [0:00:00:00]
     Actual time: 750 years, Desired time: 750 years
  Field 0 Min/Max -0.321136/-0.000000
  Field 1 Min/Max 0.864161/0.864161
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19818.256010486333 F_int: 19793.216796875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 40, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-02-15
LOOP: {'total': 40, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00075
T_s [K]: 2689.2490835764315
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  550    Interior  2694.881325  20123.590908  20099.484375  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  550  Atmosphere  2694.881325  20123.590908  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600    Interior  2693.495600  20048.512084  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600  Atmosphere  2693.495600  20048.512084  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650    Interior  2692.094125  19972.580081  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650  Atmosphere  2692.094125  19972.580081  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700    Interior  2690.678122  19895.856010  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700  Atmosphere  2690.678122  19895.856010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750    Interior  2689.249084  19818.256010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750  Atmosphere  2689.249084  19818.256010  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19818.256010486333
F_atm [W/m^2]: 19714.962890625
F_net [W/m^2]: -1.0
Last file name: 750.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 14, 20, 30, 40, 56, 76, 100, 260, 470, 750]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999250.0 50.0 126
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 41, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19714.962890625
    -teqm
    623.9007141813836
    -nstepsmacro
    126
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//750.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     126            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 236682.000000, Will perform 126 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 121, t=236682.000000. [0:00:00:00]
     Actual time: 750 years, Desired time: 750 years
  Field 0 Min/Max -0.321136/-0.000000
  Field 1 Min/Max 0.864161/0.864161
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 112
  SUNDIALS no. of calls to rhs function 131
  SUNDIALS no. of calls to linear solver setup function 26
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 130
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94707488880832
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 109
  maximum steps=100000000
  maximum time=239838.
  total number of RHS function evaluations=451
  total number of nonlinear solver iterations=7720
  total number of linear solver iterations=-835030080
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 122, t=239837.760000. [0:00:00:00]
     Actual time: 760 years, Desired time: 760 years
  Field 0 Min/Max -0.331616/-0.000000
  Field 1 Min/Max 0.864092/0.864092
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 123, t=242993.520000. [0:00:00:00]
     Actual time: 770 years, Desired time: 770 years
  Field 0 Min/Max -0.342332/-0.000000
  Field 1 Min/Max 0.864022/0.864022
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 124, t=246149.280000. [0:00:00:00]
     Actual time: 780 years, Desired time: 780 years
  Field 0 Min/Max -0.353280/-0.000000
  Field 1 Min/Max 0.863953/0.863953
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 125, t=249305.040000. [0:00:00:00]
     Actual time: 790 years, Desired time: 790 years
  Field 0 Min/Max -0.364460/-0.000000
  Field 1 Min/Max 0.863883/0.863883
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 126, t=252460.800000. [0:00:00:00]
     Actual time: 800 years, Desired time: 800 years
  Field 0 Min/Max -0.375866/-0.000000
  Field 1 Min/Max 0.863813/0.863813
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19740.167338785875 F_int: 19714.962890624996
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 41, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-02-47
LOOP: {'total': 41, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0008
T_s [K]: 2687.808636185536
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  600    Interior  2693.495600  20048.512084  20024.138672  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  600  Atmosphere  2693.495600  20048.512084  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650    Interior  2692.094125  19972.580081  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650  Atmosphere  2692.094125  19972.580081  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700    Interior  2690.678122  19895.856010  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700  Atmosphere  2690.678122  19895.856010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750    Interior  2689.249084  19818.256010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750  Atmosphere  2689.249084  19818.256010  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800    Interior  2687.808636  19740.167339  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800  Atmosphere  2687.808636  19740.167339  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19740.167338785875
F_atm [W/m^2]: 19636.123046875
F_net [W/m^2]: -1.0
Last file name: 800.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 14, 22, 30, 42, 58, 78, 130, 290, 510, 800]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999200.0 50.0 131
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 42, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19636.123046875
    -teqm
    623.9006679318952
    -nstepsmacro
    131
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//800.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     131            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 252460.800000, Will perform 131 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 126, t=252460.800000. [0:00:00:00]
     Actual time: 800 years, Desired time: 800 years
  Field 0 Min/Max -0.375866/-0.000000
  Field 1 Min/Max 0.863813/0.863813
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 129
  SUNDIALS no. of calls to linear solver setup function 27
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 128
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94038698322112
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 104
  maximum steps=100000000
  maximum time=255617.
  total number of RHS function evaluations=449
  total number of nonlinear solver iterations=7425
  total number of linear solver iterations=389309376
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 127, t=255616.560000. [0:00:00:00]
     Actual time: 810 years, Desired time: 810 years
  Field 0 Min/Max -0.387450/-0.000000
  Field 1 Min/Max 0.863743/0.863743
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 128, t=258772.320000. [0:00:00:00]
     Actual time: 820 years, Desired time: 820 years
  Field 0 Min/Max -0.399250/-0.000000
  Field 1 Min/Max 0.863673/0.863673
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 129, t=261928.080000. [0:00:00:00]
     Actual time: 830 years, Desired time: 830 years
  Field 0 Min/Max -0.411261/-0.000000
  Field 1 Min/Max 0.863603/0.863603
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 130, t=265083.840000. [0:00:00:00]
     Actual time: 840 years, Desired time: 840 years
  Field 0 Min/Max -0.423479/-0.000000
  Field 1 Min/Max 0.863533/0.863533
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 131, t=268239.600000. [0:00:00:00]
     Actual time: 850 years, Desired time: 850 years
  Field 0 Min/Max -0.435898/-0.000000
  Field 1 Min/Max 0.863463/0.863463
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19661.46255515834 F_int: 19636.123046875
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 42, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-03-19
LOOP: {'total': 42, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00085
T_s [K]: 2686.358484047085
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  650    Interior  2692.094125  19972.580081  19947.958984  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  650  Atmosphere  2692.094125  19972.580081  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700    Interior  2690.678122  19895.856010  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700  Atmosphere  2690.678122  19895.856010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750    Interior  2689.249084  19818.256010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750  Atmosphere  2689.249084  19818.256010  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800    Interior  2687.808636  19740.167339  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800  Atmosphere  2687.808636  19740.167339  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  850    Interior  2686.358484  19661.462555  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  850  Atmosphere  2686.358484  19661.462555  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19661.46255515834
F_atm [W/m^2]: 19556.923828125
F_net [W/m^2]: -1.0
Last file name: 850.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 16, 22, 32, 46, 62, 82, 150, 320, 550, 850]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999150.0 50.0 136
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 43, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19556.923828125
    -teqm
    623.9006216823965
    -nstepsmacro
    136
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//850.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     136            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 268239.600000, Will perform 136 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 131, t=268239.600000. [0:00:00:00]
     Actual time: 850 years, Desired time: 850 years
  Field 0 Min/Max -0.435898/-0.000000
  Field 1 Min/Max 0.863463/0.863463
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 117
  SUNDIALS no. of calls to rhs function 134
  SUNDIALS no. of calls to linear solver setup function 28
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 133
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93990697568448
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 104
  maximum steps=100000000
  maximum time=271395.
  total number of RHS function evaluations=454
  total number of nonlinear solver iterations=8239
  total number of linear solver iterations=-366804032
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 132, t=271395.360000. [0:00:00:00]
     Actual time: 860 years, Desired time: 860 years
  Field 0 Min/Max -0.448460/-0.000000
  Field 1 Min/Max 0.863393/0.863393
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 133, t=274551.120000. [0:00:00:00]
     Actual time: 870 years, Desired time: 870 years
  Field 0 Min/Max -0.461207/-0.000000
  Field 1 Min/Max 0.863322/0.863322
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 134, t=277706.880000. [0:00:00:00]
     Actual time: 880 years, Desired time: 880 years
  Field 0 Min/Max -0.474132/-0.000000
  Field 1 Min/Max 0.863252/0.863252
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 135, t=280862.640000. [0:00:00:00]
     Actual time: 890 years, Desired time: 890 years
  Field 0 Min/Max -0.487227/-0.000000
  Field 1 Min/Max 0.863182/0.863182
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 136, t=284018.400000. [0:00:00:00]
     Actual time: 900 years, Desired time: 900 years
  Field 0 Min/Max -0.500483/-0.000000
  Field 1 Min/Max 0.863111/0.863111
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19582.369521406472 F_int: 19556.923828125004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 43, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-03-50
LOOP: {'total': 43, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.0009
T_s [K]: 2684.900298573217
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  700    Interior  2690.678122  19895.856010  19871.011719  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  700  Atmosphere  2690.678122  19895.856010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750    Interior  2689.249084  19818.256010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750  Atmosphere  2689.249084  19818.256010  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800    Interior  2687.808636  19740.167339  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800  Atmosphere  2687.808636  19740.167339  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  850    Interior  2686.358484  19661.462555  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  850  Atmosphere  2686.358484  19661.462555  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  900    Interior  2684.900299  19582.369521  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  900  Atmosphere  2684.900299  19582.369521  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19582.369521406472
F_atm [W/m^2]: 19477.404296875
F_net [W/m^2]: -1.0
Last file name: 900.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 16, 24, 34, 48, 64, 86, 170, 350, 590, 900]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999100.0 50.0 141
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 44, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19477.404296875
    -teqm
    623.9005754328875
    -nstepsmacro
    141
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//900.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     141            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 284018.400000, Will perform 141 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 136, t=284018.400000. [0:00:00:00]
     Actual time: 900 years, Desired time: 900 years
  Field 0 Min/Max -0.500483/-0.000000
  Field 1 Min/Max 0.863111/0.863111
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 116
  SUNDIALS no. of calls to rhs function 134
  SUNDIALS no. of calls to linear solver setup function 26
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 133
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94708665391296
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 109
  maximum steps=100000000
  maximum time=287174.
  total number of RHS function evaluations=454
  total number of nonlinear solver iterations=8024
  total number of linear solver iterations=341480384
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 137, t=287174.160000. [0:00:00:00]
     Actual time: 910 years, Desired time: 910 years
  Field 0 Min/Max -0.513839/-0.000000
  Field 1 Min/Max 0.863040/0.863040
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 138, t=290329.920000. [0:00:00:00]
     Actual time: 920 years, Desired time: 920 years
  Field 0 Min/Max -0.527337/-0.000000
  Field 1 Min/Max 0.862970/0.862970
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 139, t=293485.680000. [0:00:00:00]
     Actual time: 930 years, Desired time: 930 years
  Field 0 Min/Max -0.540968/-0.000000
  Field 1 Min/Max 0.862899/0.862899
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 140, t=296641.440000. [0:00:00:00]
     Actual time: 940 years, Desired time: 940 years
  Field 0 Min/Max -0.554722/-0.000000
  Field 1 Min/Max 0.862828/0.862828
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 141, t=299797.200000. [0:00:00:00]
     Actual time: 950 years, Desired time: 950 years
  Field 0 Min/Max -0.568591/-0.000000
  Field 1 Min/Max 0.862757/0.862757
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19502.92929338895 F_int: 19477.404296875004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 44, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-04-22
LOOP: {'total': 44, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00095
T_s [K]: 2683.43566563725
Phi_global: 1.0
Helpfile properties:
  Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  750    Interior  2689.249084  19818.256010  19793.216797  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  750  Atmosphere  2689.249084  19818.256010  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800    Interior  2687.808636  19740.167339  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  800  Atmosphere  2687.808636  19740.167339  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  850    Interior  2686.358484  19661.462555  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  850  Atmosphere  2686.358484  19661.462555  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  900    Interior  2684.900299  19582.369521  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  900  Atmosphere  2684.900299  19582.369521  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  950    Interior  2683.435666  19502.929293  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  950  Atmosphere  2683.435666  19502.929293  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19502.92929338895
F_atm [W/m^2]: 19397.77734375
F_net [W/m^2]: -1.0
Last file name: 950.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 18, 26, 36, 50, 66, 90, 190, 380, 630, 950]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10 50 4566999050.0 50.0 146
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 45, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19397.77734375
    -teqm
    623.9005291833683
    -nstepsmacro
    146
    -dtmacro
    10
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//950.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3155.76         3.15576e+08     s
nstepsmacro     146            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 299797.200000, Will perform 146 macro (output) steps of length 3155.760000 = 10.000000 years
***  Writing output at macro Step 141, t=299797.200000. [0:00:00:00]
     Actual time: 950 years, Desired time: 950 years
  Field 0 Min/Max -0.568591/-0.000000
  Field 1 Min/Max 0.862757/0.862757
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 110
  SUNDIALS no. of calls to rhs function 129
  SUNDIALS no. of calls to linear solver setup function 27
  SUNDIALS no. of error test failures 2
  SUNDIALS no. of nonlinear solver iterations 128
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 94858112047296
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 104
  maximum steps=100000000
  maximum time=302953.
  total number of RHS function evaluations=449
  total number of nonlinear solver iterations=7451
  total number of linear solver iterations=-535718976
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 142, t=302952.960000. [0:00:00:00]
     Actual time: 960 years, Desired time: 960 years
  Field 0 Min/Max -0.582506/-0.000000
  Field 1 Min/Max 0.862686/0.862686
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 143, t=306108.720000. [0:00:00:00]
     Actual time: 970 years, Desired time: 970 years
  Field 0 Min/Max -0.596513/-0.000000
  Field 1 Min/Max 0.862616/0.862616
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 144, t=309264.480000. [0:00:00:00]
     Actual time: 980 years, Desired time: 980 years
  Field 0 Min/Max -0.610601/-0.000000
  Field 1 Min/Max 0.862545/0.862545
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 145, t=312420.240000. [0:00:00:00]
     Actual time: 990 years, Desired time: 990 years
  Field 0 Min/Max -0.624760/-0.000000
  Field 1 Min/Max 0.862474/0.862474
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
***  Writing output at macro Step 146, t=315576.000000. [0:00:00:00]
     Actual time: 1000 years, Desired time: 1000 years
  Field 0 Min/Max -0.638980/-0.000000
  Field 1 Min/Max 0.862402/0.862402
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19423.35743940244 F_int: 19397.77734375
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 45, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-04-55
LOOP: {'total': 45, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.001
T_s [K]: 2681.966034387418
Phi_global: 1.0
Helpfile properties:
   Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   800    Interior  2687.808636  19740.167339  19714.962891  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   800  Atmosphere  2687.808636  19740.167339  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   850    Interior  2686.358484  19661.462555  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   850  Atmosphere  2686.358484  19661.462555  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   900    Interior  2684.900299  19582.369521  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   900  Atmosphere  2684.900299  19582.369521  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950    Interior  2683.435666  19502.929293  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950  Atmosphere  2683.435666  19502.929293  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000    Interior  2681.966034  19423.357439  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000  Atmosphere  2681.966034  19423.357439  19318.039062  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.000000000000001  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19423.35743940244
F_atm [W/m^2]: 19318.0390625
F_net [W/m^2]: -1.0
Last file name: 1000.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 18, 26, 38, 52, 70, 94, 220, 410, 670, 1000]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10000.0 100000.0 4566999000.0 100000.0 156
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 46, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    19318.0390625
    -teqm
    623.9004829338388
    -nstepsmacro
    156
    -dtmacro
    10000.0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200000.0
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400000.0
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    99999.99999999997
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//1000.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3.15576e+06     3.15576e+11     s
nstepsmacro     156            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 315576.000000, Will perform 156 macro (output) steps of length 3155760.000000 = 10000.000000 years
***  Writing output at macro Step 146, t=315576.000000. [0:00:00:00]
     Actual time: 1000 years, Desired time: 1000 years
  Field 0 Min/Max -0.638980/-0.000000
  Field 1 Min/Max 0.862402/0.862402
  Field 2 Min/Max 0.100000/0.400000
Option left: name:-mass_coord_snes_trtol value: 0 source: code
tsurf change exceeded (max= 19.555238)
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 977
  SUNDIALS no. of calls to rhs function 1466
  SUNDIALS no. of calls to linear solver setup function 233
  SUNDIALS no. of error test failures 92
  SUNDIALS no. of nonlinear solver iterations 1465
  SUNDIALS no. of nonlinear convergence failure 0
  SUNDIALS no. of Jacobian-vector product evaluations 93946931722432
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 964
  maximum steps=100000000
  maximum time=3.47134e+06
  total number of RHS function evaluations=2874
  total number of nonlinear solver iterations=698572
  total number of linear solver iterations=-1182977088
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 147, t=630556.139253. [0:00:00:02]
     Actual time: 1998 years, Desired time: 11000 years
  Field 0 Min/Max -1.472453/-0.000000
  Field 1 Min/Max 0.855053/0.855053
  Field 2 Min/Max 0.100006/0.400051
Option left: name:-mass_coord_snes_trtol value: 0 source: code
Stopping macro timestepping loop early!
***  Writing output at macro Step 147, t=630556.139253. [0:00:00:02]
     Actual time: 1998 years, Desired time: 11000 years
  Field 0 Min/Max -1.472453/-0.000000
  Field 1 Min/Max 0.855053/0.855053
  Field 2 Min/Max 0.100006/0.400051
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 19344.660419779655 F_int: 19318.039062500004
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 46, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-05-28
LOOP: {'total': 46, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.001998
T_s [K]: 2651.9856915170053
Phi_global: 0.9998000785106455
Helpfile properties:
   Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   850    Interior  2686.358484  19661.462555  19636.123047  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   850  Atmosphere  2686.358484  19661.462555  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   900    Interior  2684.900299  19582.369521  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   900  Atmosphere  2684.900299  19582.369521  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950    Interior  2683.435666  19502.929293  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950  Atmosphere  2683.435666  19502.929293  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000    Interior  2681.966034  19423.357439  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000  Atmosphere  2681.966034  19423.357439  19318.039062  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1998    Interior  2651.985692  19344.660420  19318.039062  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  1998  Atmosphere  2651.985692  19344.660420  17764.103516  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.001261303197671  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 19344.660419779655
F_atm [W/m^2]: 17764.103515625
F_net [W/m^2]: -1.0
Last file name: 1998.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 18, 26, 38, 52, 70, 94, 220, 420, 680, 1998]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10000.0 100000.0 4566998002.0 100000.0 157
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 47, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    17764.103515625
    -teqm
    623.8995597910775
    -nstepsmacro
    157
    -dtmacro
    10000.0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200069.39653166223
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400050.5626398561
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100006.17114824874
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//1998.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3.15576e+06     3.15576e+11     s
nstepsmacro     157            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 630556.139253, Will perform 157 macro (output) steps of length 3155760.000000 = 10000.000000 years
***  Writing output at macro Step 147, t=630556.139253. [0:00:00:00]
     Actual time: 1998 years, Desired time: 1998 years
  Field 0 Min/Max -1.472453/-0.000000
  Field 1 Min/Max 0.855053/0.855053
  Field 2 Min/Max 0.100006/0.400051
Option left: name:-mass_coord_snes_trtol value: 0 source: code
tsurf change exceeded (max= 19.334167)
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 973
  SUNDIALS no. of calls to rhs function 1424
  SUNDIALS no. of calls to linear solver setup function 214
  SUNDIALS no. of error test failures 83
  SUNDIALS no. of nonlinear solver iterations 1423
  SUNDIALS no. of nonlinear convergence failure 1
  SUNDIALS no. of Jacobian-vector product evaluations 94194895939776
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 967
  maximum steps=100000000
  maximum time=3.78632e+06
  total number of RHS function evaluations=2832
  total number of nonlinear solver iterations=674113
  total number of linear solver iterations=1968104384
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 148, t=965704.654519. [0:00:00:02]
     Actual time: 3060 years, Desired time: 11998 years
  Field 0 Min/Max -1.565475/-0.000000
  Field 1 Min/Max 0.847577/0.847577
  Field 2 Min/Max 0.100023/0.400191
Option left: name:-mass_coord_snes_trtol value: 0 source: code
Stopping macro timestepping loop early!
***  Writing output at macro Step 148, t=965704.654519. [0:00:00:02]
     Actual time: 3060 years, Desired time: 11998 years
  Field 0 Min/Max -1.565475/-0.000000
  Field 1 Min/Max 0.847577/0.847577
  Field 2 Min/Max 0.100023/0.400191
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 17788.912107265154 F_int: 17764.103515625
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 47, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-06-05
LOOP: {'total': 47, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.00306
T_s [K]: 2621.985751576939
Phi_global: 0.9992443454943557
Helpfile properties:
   Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   900    Interior  2684.900299  19582.369521  19556.923828  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   900  Atmosphere  2684.900299  19582.369521  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950    Interior  2683.435666  19502.929293  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950  Atmosphere  2683.435666  19502.929293  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000    Interior  2681.966034  19423.357439  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000  Atmosphere  2681.966034  19423.357439  19318.039062  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1998    Interior  2651.985692  19344.660420  19318.039062  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  1998  Atmosphere  2651.985692  19344.660420  17764.103516  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  3060    Interior  2621.985752  17788.912107  17764.103516  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  3060  Atmosphere  2621.985752  17788.912107  16506.642578  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.004770838908384  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 17788.912107265154
F_atm [W/m^2]: 16506.642578125
F_net [W/m^2]: -1.0
Last file name: 3060.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 18, 26, 38, 52, 70, 94, 230, 430, 680, 3060]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10000.0 100000.0 4566996940.0 100000.0 158
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 48, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    16506.642578125
    -teqm
    623.89857744428
    -nstepsmacro
    158
    -dtmacro
    10000.0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200262.52684031788
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400191.21739028074
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100023.33966023973
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//3060.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3.15576e+06     3.15576e+11     s
nstepsmacro     158            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 965704.654519, Will perform 158 macro (output) steps of length 3155760.000000 = 10000.000000 years
***  Writing output at macro Step 148, t=965704.654519. [0:00:00:00]
     Actual time: 3060 years, Desired time: 3060 years
  Field 0 Min/Max -1.565475/-0.000000
  Field 1 Min/Max 0.847577/0.847577
  Field 2 Min/Max 0.100023/0.400191
Option left: name:-mass_coord_snes_trtol value: 0 source: code
tsurf change exceeded (max= 19.112952)
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 1011
  SUNDIALS no. of calls to rhs function 1497
  SUNDIALS no. of calls to linear solver setup function 221
  SUNDIALS no. of error test failures 88
  SUNDIALS no. of nonlinear solver iterations 1496
  SUNDIALS no. of nonlinear convergence failure 1
  SUNDIALS no. of Jacobian-vector product evaluations 94790485727424
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 998
  maximum steps=100000000
  maximum time=4.12146e+06
  total number of RHS function evaluations=2969
  total number of nonlinear solver iterations=724275
  total number of linear solver iterations=557437888
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 149, t=1321419.890487. [0:00:00:02]
     Actual time: 4187 years, Desired time: 13060 years
  Field 0 Min/Max -1.608674/-0.000000
  Field 1 Min/Max 0.839983/0.839983
  Field 2 Min/Max 0.100052/0.400430
Option left: name:-mass_coord_snes_trtol value: 0 source: code
Stopping macro timestepping loop early!
***  Writing output at macro Step 149, t=1321419.890487. [0:00:00:02]
     Actual time: 4187 years, Desired time: 13060 years
  Field 0 Min/Max -1.608674/-0.000000
  Field 1 Min/Max 0.839983/0.839983
  Field 2 Min/Max 0.100052/0.400430
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 16529.96575593587 F_int: 16506.642578125
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 48, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-06-38
LOOP: {'total': 48, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.004187
T_s [K]: 2592.003652986388
Phi_global: 0.9983037646900442
Helpfile properties:
   Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0   950    Interior  2683.435666  19502.929293  19477.404297  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0   950  Atmosphere  2683.435666  19502.929293  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000    Interior  2681.966034  19423.357439  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000  Atmosphere  2681.966034  19423.357439  19318.039062  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1998    Interior  2651.985692  19344.660420  19318.039062  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  1998  Atmosphere  2651.985692  19344.660420  17764.103516  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  3060    Interior  2621.985752  17788.912107  17764.103516  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  3060  Atmosphere  2621.985752  17788.912107  16506.642578  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  4187    Interior  2592.003653  16529.965756  16506.642578  ...  2.613005e+18           0.0  1.216105e+21  6.065819e+20        0.0
0  4187  Atmosphere  2592.003653  16529.965756  15330.041992  ...  2.613005e+18           0.0  1.216105e+21  6.065819e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.010719851675695  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 16529.96575593587
F_atm [W/m^2]: 15330.0419921875
F_net [W/m^2]: -1.0
Last file name: 4187.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 18, 28, 38, 52, 72, 96, 230, 430, 690, 4187]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10000.0 100000.0 4566995813.0 100000.0 159
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 49, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    15330.0419921875
    -teqm
    623.8975349676036
    -nstepsmacro
    159
    -dtmacro
    10000.0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    200590.02517187188
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400429.52644281194
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100052.43355288576
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//4187.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3.15576e+06     3.15576e+11     s
nstepsmacro     159            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 1321419.890487, Will perform 159 macro (output) steps of length 3155760.000000 = 10000.000000 years
***  Writing output at macro Step 149, t=1321419.890487. [0:00:00:00]
     Actual time: 4187 years, Desired time: 4187 years
  Field 0 Min/Max -1.608674/-0.000000
  Field 1 Min/Max 0.839983/0.839983
  Field 2 Min/Max 0.100052/0.400430
Option left: name:-mass_coord_snes_trtol value: 0 source: code
tsurf change exceeded (max= 18.891868)
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 968
  SUNDIALS no. of calls to rhs function 1436
  SUNDIALS no. of calls to linear solver setup function 210
  SUNDIALS no. of error test failures 73
  SUNDIALS no. of nonlinear solver iterations 1435
  SUNDIALS no. of nonlinear convergence failure 1
  SUNDIALS no. of Jacobian-vector product evaluations 93960754936000
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 918
  maximum steps=100000000
  maximum time=4.47718e+06
  total number of RHS function evaluations=2908
  total number of nonlinear solver iterations=664814
  total number of linear solver iterations=-244665408
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 150, t=1699388.273285. [0:00:00:02]
     Actual time: 5385 years, Desired time: 14187 years
  Field 0 Min/Max -1.653252/-0.000000
  Field 1 Min/Max 0.832263/0.832263
  Field 2 Min/Max 0.100095/0.400777
Option left: name:-mass_coord_snes_trtol value: 0 source: code
Stopping macro timestepping loop early!
***  Writing output at macro Step 150, t=1699388.273285. [0:00:00:02]
     Actual time: 5385 years, Desired time: 14187 years
  Field 0 Min/Max -1.653252/-0.000000
  Field 1 Min/Max 0.832263/0.832263
  Field 2 Min/Max 0.100095/0.400777
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 15351.959190578149 F_int: 15330.041992187498
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 49, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-07-13
LOOP: {'total': 49, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.005385
T_s [K]: 2562.0155053023714
Phi_global: 0.9969331337419995
Helpfile properties:
   Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  1000    Interior  2681.966034  19423.357439  19397.777344  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1000  Atmosphere  2681.966034  19423.357439  19318.039062  ...  2.616073e+18           0.0  1.213158e+21  6.065788e+20        0.0
0  1998    Interior  2651.985692  19344.660420  19318.039062  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  1998  Atmosphere  2651.985692  19344.660420  17764.103516  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  3060    Interior  2621.985752  17788.912107  17764.103516  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  3060  Atmosphere  2621.985752  17788.912107  16506.642578  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  4187    Interior  2592.003653  16529.965756  16506.642578  ...  2.613005e+18           0.0  1.216105e+21  6.065819e+20        0.0
0  4187  Atmosphere  2592.003653  16529.965756  15330.041992  ...  2.613005e+18           0.0  1.216105e+21  6.065819e+20        0.0
0  5385    Interior  2562.015505  15351.959191  15330.041992  ...  2.610525e+18           0.0  1.218496e+21  6.065844e+20        0.0
0  5385  Atmosphere  2562.015505  15351.959191  14179.469727  ...  2.610525e+18           0.0  1.218496e+21  6.065844e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.019412682002781  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 15351.959190578149
F_atm [W/m^2]: 14179.4697265625
F_net [W/m^2]: -1.0
Last file name: 5385.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 18, 28, 38, 54, 72, 96, 240, 440, 700, 5385]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10000.0 100000.0 4566994615.0 100000.0 160
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 50, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    14179.4697265625
    -teqm
    623.8964268100918
    -nstepsmacro
    160
    -dtmacro
    10000.0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    201068.85141471084
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    400777.4897233457
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100094.92706222163
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//5385.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3.15576e+06     3.15576e+11     s
nstepsmacro     160            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 1699388.273285, Will perform 160 macro (output) steps of length 3155760.000000 = 10000.000000 years
***  Writing output at macro Step 150, t=1699388.273285. [0:00:00:00]
     Actual time: 5385 years, Desired time: 5385 years
  Field 0 Min/Max -1.653252/-0.000000
  Field 1 Min/Max 0.832263/0.832263
  Field 2 Min/Max 0.100095/0.400777
Option left: name:-mass_coord_snes_trtol value: 0 source: code
tsurf change exceeded (max= 18.670739)
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 1108
  SUNDIALS no. of calls to rhs function 1672
  SUNDIALS no. of calls to linear solver setup function 243
  SUNDIALS no. of error test failures 93
  SUNDIALS no. of nonlinear solver iterations 1671
  SUNDIALS no. of nonlinear convergence failure 1
  SUNDIALS no. of Jacobian-vector product evaluations 93993165686976
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 1094
  maximum steps=100000000
  maximum time=4.85515e+06
  total number of RHS function evaluations=3208
  total number of nonlinear solver iterations=903161
  total number of linear solver iterations=2101314496
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 151, t=2101986.838815. [0:00:00:02]
     Actual time: 6661 years, Desired time: 15385 years
  Field 0 Min/Max -1.695257/-0.000000
  Field 1 Min/Max 0.824419/0.824419
  Field 2 Min/Max 0.100152/0.401248
Option left: name:-mass_coord_snes_trtol value: 0 source: code
Stopping macro timestepping loop early!
***  Writing output at macro Step 151, t=2101986.838815. [0:00:00:02]
     Actual time: 6661 years, Desired time: 15385 years
  Field 0 Min/Max -1.695257/-0.000000
  Field 1 Min/Max 0.824419/0.824419
  Field 2 Min/Max 0.100152/0.401248
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 14199.98966174257 F_int: 14179.469726562498
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 50, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
Mapping sub-bands to channels.
Mapping sub-bands to channels.
TROPOPAUSE SET BY HEATING
Mapping sub-bands to channels.
Mapping sub-bands to channels.
-------------------------------------------------------------------------------------------------------------
Remove SOCRATES auxiliary files: >>> Done.
Early MO phase and RF is deep in mantle. RF_depth =  0.45000000000000007
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End atmosphere
---------------------------------------------------------
==> RUNTIME INFO <==
2023-05-27_15-07-48
LOOP: {'total': 50, 'init': 3, 'atm': 1, 'init_loops': 3, 'atm_loops': 10}
Time [Myr]: 0.006661
T_s [K]: 2532.045225645402
Phi_global: 0.9950839054512471
Helpfile properties:
   Time       Input       T_surf         F_int         F_atm  ...  C_mol_liquid  N_mol_liquid     O_mol_atm     C_mol_atm  N_mol_atm
0  1998    Interior  2651.985692  19344.660420  19318.039062  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  1998  Atmosphere  2651.985692  19344.660420  17764.103516  ...  2.615711e+18           0.0  1.213504e+21  6.065792e+20        0.0
0  3060    Interior  2621.985752  17788.912107  17764.103516  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  3060  Atmosphere  2621.985752  17788.912107  16506.642578  ...  2.614706e+18           0.0  1.214469e+21  6.065802e+20        0.0
0  4187    Interior  2592.003653  16529.965756  16506.642578  ...  2.613005e+18           0.0  1.216105e+21  6.065819e+20        0.0
0  4187  Atmosphere  2592.003653  16529.965756  15330.041992  ...  2.613005e+18           0.0  1.216105e+21  6.065819e+20        0.0
0  5385    Interior  2562.015505  15351.959191  15330.041992  ...  2.610525e+18           0.0  1.218496e+21  6.065844e+20        0.0
0  5385  Atmosphere  2562.015505  15351.959191  14179.469727  ...  2.610525e+18           0.0  1.218496e+21  6.065844e+20        0.0
0  6661    Interior  2532.045226  14199.989662  14179.469727  ...  2.607180e+18           0.0  1.221733e+21  6.065877e+20        0.0
0  6661  Atmosphere  2532.045226  14199.989662  13233.237305  ...  2.607180e+18           0.0  1.221733e+21  6.065877e+20        0.0

[10 rows x 93 columns]
P_surf [bar]: 7.0311824925409985  
TOA heating [W/m^2]: 0.0
F_int [W/m^2]: 14199.98966174257
F_atm [W/m^2]: 13233.2373046875
F_net [W/m^2]: -1.0
Last file name: 6661.json
---------------------------------------------------------
-------------------------------------------------------------------------------------------------------------
Updating plots...
-------------------------------------------------------------------------------------------------------------
snapshots: [0, 20, 28, 40, 54, 72, 96, 240, 440, 710, 6661]
Start interior
IC_INTERIOR = 2
TIME OPTIONS IN RUNSPIDER:
10000.0 100000.0 4566993339.0 100000.0 161
-------------------------------------------------------------------------------------------------------------
Running SPIDER... (loop counter =  {'total': 51, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
   Flags:
    /home/n/nichollsh/PROTEUS/SPIDER//spider
    -options_file
    /home/n/nichollsh/PROTEUS/output//init_spider.opts
    -outputDirectory
    /home/n/nichollsh/PROTEUS/output/
    -IC_INTERIOR
    2
    -IC_ATMOSPHERE
    3
    -SURFACE_BC
    4
    -surface_bc_value
    13233.2373046875
    -teqm
    623.8952464955968
    -nstepsmacro
    161
    -dtmacro
    10000.0
    -radius
    6378000.0
    -gravity
    -9.81
    -coresize
    0.55
    -volatile_names
    H2O,H2,CH4
    -tsurf_poststep_change
    30.0
    -H2O_initial_atmos_pressure
    201717.6925978008
    -H2O_henry
    1.033
    -H2O_henry_pow
    1.747
    -H2O_kdist
    0.0
    -H2O_kabs
    0.0
    -H2O_molar_mass
    0.01801528
    -H2O_SOLUBILITY 1
    -H2_initial_atmos_pressure
    401248.1310756044
    -H2_henry
    2.572e-06
    -H2_henry_pow
    1.0
    -H2_kdist
    0.0
    -H2_kabs
    0.0
    -H2_molar_mass
    0.00201588
    -H2_SOLUBILITY 1
    -CH4_initial_atmos_pressure
    100152.42558069453
    -CH4_henry
    9.937e-08
    -CH4_henry_pow
    1.0
    -CH4_kdist
    0.0
    -CH4_kabs
    0.0
    -CH4_molar_mass
    0.01604
    -CH4_SOLUBILITY 1
    -ic_interior_filename
    /home/n/nichollsh/PROTEUS/output//6661.json
    -activate_poststep
    -activate_rollback
    -H2O_poststep_change
    0.05
    -H2_poststep_change
    0.05
    -CH4_poststep_change
    0.05

::::::::::::::::: SPIDER version 0.2.0 :::::::::::::::::

Using double (64-bit) precision scalars

Using options file: /home/n/nichollsh/PROTEUS/output//init_spider.opts

**************** Magma Ocean | Parameters **************

[Scaling]                       Value           Units
--------------------------------------------------------
Radius                          6.371e+07       m     
Temperature                     135.614         K     
Entropy                         2993.03         J/kg/K
Pressure                        1e+06           Pa    
Mass                            6.371e+23       kg    
Volatile                        1e-06           mass fraction
Time                            100000          s      (0.00316881 years)
dS/dr (entropy gradient)        4.69789e-05     J/kg/K/m
S     (surface entropy)         2993.03         J/kg/K
Pv    (atmospheric pressure)    1e+06           Pa     (10 bar)
Mv    (volatile mass)           6.371e+17       kg    
--------------------------------------------------------

[Parameter]     Non-dim. Value  Dim. Value      Units
--------------------------------------------------------
dtmacro         3.15576e+06     3.15576e+11     s
nstepsmacro     161            
numpts_b        60             
numpts_s        59             
ic_adiabat_entropy 0.868686        2600            J/kg/K
--------------------------------------------------------

[Volatile] prefix/name
--------------------------------------------------------
0          H2O             (.. additional parameters omitted ..)
1          H2              (.. additional parameters omitted ..)
2          CH4             (.. additional parameters omitted ..)
--------------------------------------------------------
--------------------------------------------------------
PostStep logic active
--------------------------------------------------------
Output Directory               /home/n/nichollsh/PROTEUS/output/
--------------------------------------------------------

********************************************************

*** Timestepper will solve for coupled fields:
  0: dS/dxi (60 entries)
  1: S at top staggered node (1 entry)
  2: Volatile partial pressure (3 entries)


**************** Volatile content **************
Equivalent present-day mass of ocean water from H2 (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2 (bar) 104.098        
Equivalent present-day mass of ocean water from H2O (non-dimensional) 3.49963        
Equivalent atmospheric pressure of H2O (bar) 930.293        
************************************************

*** Starting at t0 = 2101986.838815, Will perform 161 macro (output) steps of length 3155760.000000 = 10000.000000 years
***  Writing output at macro Step 151, t=2101986.838815. [0:00:00:00]
     Actual time: 6661 years, Desired time: 6661 years
  Field 0 Min/Max -1.695257/-0.000000
  Field 1 Min/Max 0.824419/0.824419
  Field 2 Min/Max 0.100152/0.401248
Option left: name:-mass_coord_snes_trtol value: 0 source: code
tsurf change exceeded (max= 18.449742)
TS Object: 1 MPI process
  type: sundials
  SUNDIALS integrator does not use SNES!
  SUNDIALS integrator type BDF: backward differentiation formula
  SUNDIALS maxord -2
  SUNDIALS abs tol 1e-10 rel tol 1e-10
  SUNDIALS integrator using a dense linear solve
  SUNDIALS suggested factor for tolerance scaling 1.
  SUNDIALS cumulative number of internal steps 970
  SUNDIALS no. of calls to rhs function 1500
  SUNDIALS no. of calls to linear solver setup function 227
  SUNDIALS no. of error test failures 79
  SUNDIALS no. of nonlinear solver iterations 1499
  SUNDIALS no. of nonlinear convergence failure 1
  SUNDIALS no. of Jacobian-vector product evaluations 94772811577536
  SUNDIALS no. of rhs calls for finite diff. Jacobian-vector evals 948
  maximum steps=100000000
  maximum time=5.25775e+06
  total number of RHS function evaluations=3036
  total number of nonlinear solver iterations=689583
  total number of linear solver iterations=63157184
  total number of nonlinear solve failures=0
  total number of rejected steps=0
  using relative error tolerance of 0.0001,   using absolute error tolerance of 0.0001
  TSAdapt Object: 1 MPI process
    type: none
  SNES Object: 1 MPI process
    type: newtonls
    SNES has not been set up so information may be incomplete
    maximum iterations=50, maximum function evaluations=10000
    tolerances: relative=1e-08, absolute=1e-50, solution=1e-08
    total number of linear solver iterations=0
    total number of function evaluations=0
    norm schedule ALWAYS
    SNESLineSearch Object: 1 MPI process
      type: bt
        interpolation: cubic
        alpha=1.000000e-04
      maxstep=1.000000e+08, minlambda=1.000000e-12
      tolerances: relative=1.000000e-08, absolute=1.000000e-15, lambda=1.000000e-08
      maximum iterations=40
    KSP Object: 1 MPI process
      type: gmres
        restart=30, using Classical (unmodified) Gram-Schmidt Orthogonalization with no iterative refinement
        happy breakdown tolerance 1e-30
      maximum iterations=10000, initial guess is zero
      tolerances:  relative=1e-05, absolute=1e-50, divergence=10000.
      left preconditioning
      using DEFAULT norm type for convergence test
    PC Object: 1 MPI process
      type: none
      PC has not been set up so information may be incomplete
***  Writing output at macro Step 152, t=2526059.110043. [0:00:00:02]
     Actual time: 8005 years, Desired time: 16661 years
  Field 0 Min/Max -1.734618/-0.000000
  Field 1 Min/Max 0.816461/0.816461
  Field 2 Min/Max 0.100227/0.401856
Option left: name:-mass_coord_snes_trtol value: 0 source: code
Stopping macro timestepping loop early!
***  Writing output at macro Step 152, t=2526059.110043. [0:00:00:02]
     Actual time: 8005 years, Desired time: 16661 years
  Field 0 Min/Max -1.734618/-0.000000
  Field 1 Min/Max 0.816461/0.816461
  Field 2 Min/Max 0.100227/0.401856
Option left: name:-mass_coord_snes_trtol value: 0 source: code
>>>>>>> F_int2: 13252.628212840711 F_int: 13233.237304687498
/home/n/nichollsh/PROTEUS/output//runtime_helpfile.csv
End interior
Start atmosphere
-------------------------------------------------------------------------------------------------------------
SOCRATES run... (loop = {'total': 51, 'init': 3, 'atm': 0, 'init_loops': 3, 'atm_loops': 10} )
-------------------------------------------------------------------------------------------------------------
